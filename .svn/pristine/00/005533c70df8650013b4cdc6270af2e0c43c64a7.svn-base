/* Author: Dipali Revanwar
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

var config = require('config');
var mongoose = require('mongoose');
mongoose.Promise = global.Promise;
var kyc_detail = require('../models/kyc_detail');
var kyc_history = require('../models/kyc_history');
var moment = require('moment');
//let jwt = require('jwt-simple');
//let secret = 'xxx';
var fs = require('fs');
var path = require('path');
var appRoot = path.dirname(path.dirname(require.main.filename));
module.exports.controller = function (app) {
    app.post('/kyc_details/hdfc_fetch_kyc_details', function (req, res) {
        try {
            let req_txt = {
                "mobile": (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                "name": "",
                "kyc_id": "",
                //"dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : (moment(req.body.dob).format("DD/MM/YYYY")), //"31/10/2000",
                "dob": (req.body.DOB === undefined || req.body.DOB === "" || req.body.DOB === null) ? "" : req.body.DOB,
                "ckyc_number": "",
                "pan": (req.body.PAN === undefined || req.body.PAN === "" || req.body.PAN === null) ? "" : req.body.PAN,
                "aadhaar_uid": (req.body.Aadhar === undefined || req.body.Aadhar === "" || req.body.Aadhar === null) ? "" : (req.body.Aadhar.substr(req.body.Aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": "",
                "redirect_url": ""
            };
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "token": ""
                }
            };
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            let kyc_url = "";
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.get("https://ctrln-uat.hdfcergo.com/e-kyc/tgt/generate-token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("success") && data1.success === true) {
                        if (data1.hasOwnProperty("data") && data1.data.hasOwnProperty("token") && data1.data.token !== "" && data1.data.token !== null) {
                            token = data1.data.token;
                            try {
                                if (token) {
                                    args.headers.token = token;
                                    var client1 = new Client();
                                    client1.get("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-verified", args, function (data, response) {
                                        if (data) {
                                            let LM_Data = {
                                                'KYC_Obj': {
                                                    'KYC_Number': ''
                                                },
                                                'LM_Obj': {
                                                    'iskycVerified': '',
                                                    'redirect_link': '',
                                                    'status': ''
                                                },
                                                'HDFC_Obj': {
                                                    'data': ''
                                                },
                                                'tmp_Obj': ''
                                            };
                                            if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                if (data.data.iskycVerified === 1) {
                                                    kyc_id = (data.data.hasOwnProperty("kyc_id")) ? data.data.kyc_id : "";
                                                    KYC_Status = "SUCCESS";
                                                    LM_Data.KYC_Obj.KYC_Number = kyc_id;
                                                    LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                } else if (data.data.iskycVerified === 0) {
                                                    kyc_id = (data.data.hasOwnProperty("kyc_id")) ? data.data.kyc_id : "";
                                                    KYC_Status = "PENDING";
                                                    kyc_url = data.data.redirect_link;
                                                    LM_Data.HDFC_Obj.redirect_link = data.data.redirect_link;
                                                    LM_Data.tmp_Obj = LM_Data.HDFC_Obj.data;
                                                } else {
                                                    KYC_Status = "PENDING";
                                                    LM_Data.HDFC_Obj.data = data;
                                                    LM_Data.tmp_Obj = LM_Data.HDFC_Obj.data;
                                                }
                                            } else {
                                                KYC_Status = "PENDING";
                                                LM_Data.HDFC_Obj.data = data;
                                                LM_Data.tmp_Obj = LM_Data.HDFC_Obj.data;
                                            }

                                            try {
                                                let cond = {
                                                    'Insurer_Id': req.body.Insurer_Id - 0,
                                                    'PB_CRN': (req.body.PB_CRN === undefined || req.body.PB_CRN === "" || req.body.PB_CRN === null) ? "" : req.body.PB_CRN - 0,
                                                    'User_Data_Id': (req.body.User_Data_Id === undefined || req.body.User_Data_Id === "" || req.body.User_Data_Id === null) ? 0 : req.body.User_Data_Id - 0
                                                };
                                                let setObj = {
                                                    'KYC_Number': kyc_id,
                                                    'KYC_Status': KYC_Status,
                                                    'Modified_On': new Date(),
                                                    'KYC_URL': kyc_url
                                                };
                                                //var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail.update(cond, {$set: setObj}, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "HDFC", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "HDFC", "Msg": data.data, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (req.body.PB_CRN === undefined || req.body.PB_CRN === "" || req.body.PB_CRN === null) ? "" : req.body.PB_CRN - 0,
                                                    'User_Data_Id': (req.body.User_Data_Id === undefined || req.body.User_Data_Id === "" || req.body.User_Data_Id === null) ? 0 : req.body.User_Data_Id - 0,
                                                    'PAN': (req.body.PAN === undefined || req.body.PAN === "" || req.body.PAN === null) ? "" : req.body.PAN,
                                                    'Aadhaar': (req.body.Aadhar === undefined || req.body.Aadhar === "" || req.body.Aadhar === null) ? "" : req.body.Aadhar,
                                                    'DOB': (req.body.DOB === undefined || req.body.DOB === "" || req.body.DOB === null) ? "" : req.body.DOB,
                                                    'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile - 0,
                                                    'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                                                    'Insurer_Id': req.body.Insurer_Id - 0,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "HDFC", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "HDFC", "Msg": data.data, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "HDFC", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "HDFC", "Msg": data.data, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "HDFC", "Msg": "KYC fetch services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "HDFC", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "HDFC", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "HDFC", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "HDFC", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "HDFC", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "HDFC", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/hdfc_verify_kyc_details', function (req, res) {
        try {
            let objRequest = req.body;
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            var user_name = null;
            if (objRequest['Proposal_Request'].middle_name === undefined || objRequest['Proposal_Request'].middle_name === "" || objRequest['Proposal_Request'].middle_name === null) {
                user_name = ((objRequest['Proposal_Request'].first_name === undefined || objRequest['Proposal_Request'].first_name === "" || objRequest['Proposal_Request'].first_name === null) ? "" : objRequest['Proposal_Request'].first_name) + " " +
                        ((objRequest['Proposal_Request'].last_name === undefined || objRequest['Proposal_Request'].last_name === "" || objRequest['Proposal_Request'].last_name === null) ? "" : objRequest['Proposal_Request'].last_name);
            } else {
                user_name = ((objRequest['Proposal_Request'].first_name === undefined || objRequest['Proposal_Request'].first_name === "" || objRequest['Proposal_Request'].first_name === null) ? "" : objRequest['Proposal_Request'].first_name) + " " +
                        ((objRequest['Proposal_Request'].middle_name === undefined || objRequest['Proposal_Request'].middle_name === "" || objRequest['Proposal_Request'].middle_name === null) ? "" : objRequest['Proposal_Request'].middle_name) + " " +
                        ((objRequest['Proposal_Request'].last_name === undefined || objRequest['Proposal_Request'].last_name === "" || objRequest['Proposal_Request'].last_name === null) ? "" : objRequest['Proposal_Request'].last_name);
            }
            let req_txt = {
                "mobile": (objRequest.Mobile === undefined || objRequest.Mobile === "" || objRequest.Mobile === null) ? "" : objRequest.Mobile,
                "name": user_name,
                "kyc_id": user_kyc_no,
                "dob": (objRequest.DOB === undefined || objRequest.DOB === "" || objRequest.DOB === null) ? "" : objRequest.DOB,
                "ckyc_number": user_kyc_no,
                "pan": (objRequest.PAN === undefined || objRequest.PAN === "" || objRequest.PAN === null) ? "" : objRequest.PAN,
                "aadhaar_uid": (objRequest.Aadhar === undefined || objRequest.Aadhar === "" || objRequest.Aadhar === null) ? "" : (objRequest.Aadhar.substr(objRequest.Aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": (objRequest.Email === undefined || objRequest.Email === "" || objRequest.Email === null) ? "" : objRequest.Email,
                "redirect_url": ""
            };
            let args = {headers: {"token": ""}};
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.get("https://ctrln-uat.hdfcergo.com/e-kyc/tgt/generate-token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("success") && data1.success === true) {
                        if (data1.hasOwnProperty("data") && data1.data.hasOwnProperty("token") && data1.data.token !== "" && data1.data.token !== null) {
                            token = data1.data.token;
                            try {
                                if (token) {
                                    args.headers.token = token;
                                    var client1 = new Client();
                                    client1.get("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-status/" + user_kyc_no, args, function (data, response) {
                                        if (data) {
                                            let LM_Data = {
                                                'KYC_Obj': {
                                                    'kyc_id': ''
                                                },
                                                'LM_Obj': {
                                                    'iskycVerified': '',
                                                    'redirect_link': '',
                                                    'status': ''
                                                },
                                                'Hdfc_Obj': {
                                                    'data': ''
                                                },
                                                'tmp_Obj': ''
                                            };
                                            if (data.hasOwnProperty("message") && data.message !== "") {
                                                KYC_Status = "PENDING";
                                                LM_Data.Hdfc_Obj.data = data.message;
                                                LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                            } else {
                                                if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                    if (data.data.iskycVerified === 1) {
                                                        KYC_Status = "VERIFIED";
                                                        LM_Data.KYC_Obj.kyc_id = user_kyc_no;
                                                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                    } else if (data.data.iskycVerified === 0) {
                                                        KYC_Status = "PENDING";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    } else {
                                                        KYC_Status = "PENDING";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    }
                                                } else {
                                                    KYC_Status = "PENDING";
                                                    LM_Data.Hdfc_Obj.data = data;
                                                    LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                }
                                            }

                                            try {
                                                //data.data.Msg.kyc_id = user_kyc_no;
                                                let queryObj = {
//                                                    'Insurer_Id': objRequest.Insurer_Id - 0,
                                                    'Search_Type': (objRequest.Verify_Search_Type === undefined || objRequest.Verify_Search_Type === "" || objRequest.Verify_Search_Type === null) ? "" : objRequest.Verify_Search_Type,
                                                    'KYC_Number': user_kyc_no,
//                                                'Mobile': (objRequest.Mobile === undefined || objRequest.Mobile === "" || objRequest.Mobile === null) ? "" : objRequest.Mobile - 0,
//                                                'PAN': (objRequest.PAN === undefined || objRequest.PAN === "" || objRequest.PAN === null) ? "" : objRequest.PAN,
//                                                'Aadhar': (objRequest.Aadhar === undefined || objRequest.Aadhar === "" || objRequest.Aadhar === null) ? "" : objRequest.Aadhar,
                                                    'KYC_Status': KYC_Status,
//                                                'DOB': (objRequest.DOB === undefined || objRequest.DOB === "" || objRequest.DOB === null) ? "" : objRequest.DOB,
//                                                'Created_On': new Date(),
                                                    'Modified_On': new Date()
//                                                'User_Data_Id': (objRequest.User_Data_Id === undefined || objRequest.User_Data_Id === "" || objRequest.User_Data_Id === null) ? 0 : objRequest.User_Data_Id - 0,
//                                                'Product_Id': (objRequest.Product_Id === undefined || objRequest.Product_Id === "" || objRequest.Product_Id === null) ? 0 : objRequest.Product_Id - 0,
//                                                'Email': (objRequest.Email === undefined || objRequest.Email === "" || objRequest.Email === null) ? "" : objRequest.Email,
//                                                'PB_CRN': (objRequest.PB_CRN === undefined || objRequest.PB_CRN === "" || objRequest.PB_CRN === null) ? "" : objRequest.PB_CRN - 0
                                                };
                                                let cond = {
                                                    'Insurer_Id': req.body.Insurer_Id - 0,
                                                    'PB_CRN': (req.body.PB_CRN === undefined || req.body.PB_CRN === "" || req.body.PB_CRN === null) ? "" : req.body.PB_CRN - 0,
                                                    'User_Data_Id': (req.body.User_Data_Id === undefined || req.body.User_Data_Id === "" || req.body.User_Data_Id === null) ? 0 : req.body.User_Data_Id - 0
                                                };
                                                console.log(cond);
                                                console.log(queryObj);
                                                
                                                var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail1.update(cond, {$set: queryObj}, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "HDFC", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "HDFC", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (objRequest.PB_CRN === undefined || objRequest.PB_CRN === "" || objRequest.PB_CRN === null) ? "" : objRequest.PB_CRN - 0,
                                                    'User_Data_Id': (objRequest.User_Data_Id === undefined || objRequest.User_Data_Id === "" || objRequest.User_Data_Id === null) ? 0 : objRequest.User_Data_Id - 0,
                                                    'PAN': (objRequest.PAN === undefined || objRequest.PAN === "" || objRequest.PAN === null) ? "" : objRequest.PAN,
                                                    'Aadhaar': (objRequest.Aadhaar === undefined || objRequest.Aadhaar === "" || objRequest.Aadhaar === null) ? "" : objRequest.Aadhaar,
                                                    'DOB': (objRequest.DOB === undefined || objRequest.DOB === "" || objRequest.DOB === null) ? "" : objRequest.DOB,
                                                    'Mobile': (objRequest.Mobile === undefined || objRequest.Mobile === "" || objRequest.Mobile === null) ? "" : objRequest.Mobile - 0,
                                                    'Email': (objRequest.Email === undefined || objRequest.Email === "" || objRequest.Email === null) ? "" : objRequest.Email,
                                                    'Insurer_Id': objRequest.Insurer_Id - 0,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "HDFC", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "HDFC", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "HDFC", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "HDFC", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "HDFC", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "HDFC", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "HDFC", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "HDFC", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "HDFC", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "HDFC", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "HDFC", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/edelweiss_fetch_kyc_details', function (req, res) {
        try {
            let ObjRequest = req.body;
            let kyc_fetch_request = "";
            let kyc_fetch_response = "";
            let vehicle_registration_type = (ObjRequest.vehicle_registration_type === undefined || ObjRequest.vehicle_registration_type === "" || ObjRequest.vehicle_registration_type === null) ? "" : ObjRequest.vehicle_registration_type;
            vehicle_registration_type = (vehicle_registration_type === "") ? "" : (vehicle_registration_type === "corporate" ? "C" : "I");
            vehicle_registration_type = "I";
            let req_txt = {
                "VISoF_Program_Name": "PB-LIBPL", //"EGI",
                "VISoF_KYC_Req_No": (ObjRequest.PB_CRN === undefined || ObjRequest.PB_CRN === "" || ObjRequest.PB_CRN === null) ? "" : ObjRequest.PB_CRN.toString(),
                "ProposerType": vehicle_registration_type, //I=Individual or C=Corporate
                "Source": "LIBPL", //"PP",
                "FirstName": (ObjRequest.Proposal_Request.first_name === undefined || ObjRequest.Proposal_Request.first_name === "" || ObjRequest.Proposal_Request.first_name === null) ? "" : ObjRequest.Proposal_Request.first_name,
                "MiddleName": (ObjRequest.Proposal_Request.middle_name === undefined || ObjRequest.Proposal_Request.middle_name === "" || ObjRequest.Proposal_Request.middle_name === null) ? "" : ObjRequest.Proposal_Request.middle_name,
                "LastName": (ObjRequest.Proposal_Request.last_name === undefined || ObjRequest.Proposal_Request.last_name === "" || ObjRequest.Proposal_Request.last_name === null) ? "" : ObjRequest.Proposal_Request.last_name,
                "DOB": (vehicle_registration_type === "I" ? ((ObjRequest.dob === undefined || ObjRequest.dob === "" || ObjRequest.dob === null) ? "" : (moment(ObjRequest.dob, "DD/MM/YYYY").format("MM/DD/YYYY"))) : ""), //"31/10/2000",
                "DOI": (vehicle_registration_type === "C" ? ((ObjRequest.date_of_incorporation === undefined || ObjRequest.date_of_incorporation === "" || ObjRequest.date_of_incorporation === null) ? "" : (moment(ObjRequest.date_of_incorporation, "DD/MM/YYYY").format("MM/DD/YYYY"))) : ""), //"31/10/2000",
                "MobileNo": (ObjRequest.Proposal_Request.mobile === undefined || ObjRequest.Proposal_Request.mobile === "" || ObjRequest.Proposal_Request.mobile === null) ? "" : ObjRequest.Proposal_Request.mobile,
                "ZIPCODE": (ObjRequest.Proposal_Request.permanent_pincode === undefined || ObjRequest.Proposal_Request.permanent_pincode === "" || ObjRequest.Proposal_Request.permanent_pincode === null) ? "" : ObjRequest.Proposal_Request.permanent_pincode,
                "Email": (ObjRequest.Proposal_Request.email === undefined || ObjRequest.Proposal_Request.email === "" || ObjRequest.Proposal_Request.email === null) ? "" : ObjRequest.Proposal_Request.email,
                "ProposerPAN": (ObjRequest.PAN === undefined || ObjRequest.PAN === "" || ObjRequest.PAN === null) ? "" : ObjRequest.PAN, //"AQNPY8223A",
                "ProposerAadhaarNumber": (ObjRequest.Aadhar === undefined || ObjRequest.Aadhar === "" || ObjRequest.Aadhar === null) ? "" : ObjRequest.Aadhar, //"",
                "ProposerCKYCNo": ""
            };
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "*/*",
                    "Authorization": "",
                    "X-Api-Key": "vmX0qzSwUy5i4dyKa0MhuaQhQ6PECsp3FqZvwRX8"
                }
            };
            let args1 = {
                headers: {
                    "Authorization": 'Basic ' + new Buffer('2r9a4a9lpvj2lp5bqbo0jhcp0l' + ':' + '1q0fbp68juvm8f221f9ckh9j7i3ktq2hkibfk88q460pvccsfmqs').toString('base64'),
                    //"Authorization": "Basic MnI5YTRhOWxwdmoybHA1YnFibzBqaGNwMGw6MXEwZmJwNjhqdXZtOGYyMjFmOWNraDlqN2kza3RxMmhraWJmazg4cTQ2MHB2Y2NzZm1xcw==",
                    "Content-Type": "application/x-www-form-urlencoded",
                    "Accept": "*/*"
                }
            };
            kyc_fetch_request = req_txt;
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            let LM_Data = {
                "KYC_Pan_No": "",
                "KYC_Number": "",
                "KYC_FullName": "",
                "KYC_Ref_No": "",
                "KYC_Redirect_URL": "",
                "KYC_Insurer_ID": "",
                "KYC_PB_CRN": ObjRequest.PB_CRN,
                "KYC_Status": KYC_Status
            };
            client.post("https://devapi.edelweissinsurance.com/oauth2/token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("access_token") && data1.access_token !== "" && data1.access_token !== null) {
                        token = data1.access_token;
                        try {
                            if (token) {
                                args.headers.Authorization = token;
                                var client1 = new Client();
                                client1.post("https://devapi.edelweissinsurance.com/signzy/e-kyc", args, function (data, response) {
                                    if (data) {
                                        kyc_fetch_response = data;
                                        if (data.hasOwnProperty("message") && data.message !== "") {
                                            LM_Data.KYC_Status = "FETCH_FAIL";
                                        } else {
                                            if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data) {
                                                if (data.data.hasOwnProperty("KYC_Status") && (data.data.KYC_Status === '1' || data.data.KYC_Status === 1)) {
                                                    if ((data.data.hasOwnProperty("VISoF_KYC_Req_No") && data.data.VISoF_KYC_Req_No !== "") && (data.data.hasOwnProperty("IC_KYC_No") && data.data.IC_KYC_No !== "")) {
                                                        kyc_id = data.data.VISoF_KYC_Req_No + "|" + data.data.IC_KYC_No;
                                                        LM_Data.KYC_Status = "FETCH_SUCCESS";
                                                        LM_Data.KYC_Number = (kyc_id && kyc_id.includes('|')) ? kyc_id.split('|')[1] : "";
                                                    } else {
                                                        if ((data.data.hasOwnProperty("VISoF_KYC_Req_No") && data.data.VISoF_KYC_Req_No !== "") && (data.data.hasOwnProperty("IC_KYC_No") && data.data.IC_KYC_No !== "")) {
                                                            kyc_id = data.data.VISoF_KYC_Req_No + "|" + data.data.IC_KYC_No;
                                                            LM_Data.KYC_Number = (kyc_id && kyc_id.includes('|')) ? kyc_id.split('|')[1] : "";
                                                            LM_Data.KYC_Redirect_URL = data.data.IC_KYC_REG_URL;
                                                        }
                                                        LM_Data.KYC_Status = "FETCH_FAIL";
                                                    }
                                                } else {
                                                    if ((data.data.hasOwnProperty("VISoF_KYC_Req_No") && data.data.VISoF_KYC_Req_No !== "") && (data.data.hasOwnProperty("IC_KYC_No") && data.data.IC_KYC_No !== "")) {
                                                        kyc_id = data.data.VISoF_KYC_Req_No + "|" + data.data.IC_KYC_No;
                                                        LM_Data.KYC_Number = (kyc_id && kyc_id.includes('|')) ? kyc_id.split('|')[1] : "";
                                                        LM_Data.KYC_Redirect_URL = data.data.IC_KYC_REG_URL;
                                                    }
                                                    LM_Data.KYC_Status = "FETCH_FAIL";
                                                }
                                            } else {
                                                if ((data.data.hasOwnProperty("VISoF_KYC_Req_No") && data.data.VISoF_KYC_Req_No !== "") && (data.data.hasOwnProperty("IC_KYC_No") && data.data.IC_KYC_No !== "")) {
                                                    kyc_id = data.data.VISoF_KYC_Req_No + "|" + data.data.IC_KYC_No;
                                                    LM_Data.KYC_Number = (kyc_id && kyc_id.includes('|')) ? kyc_id.split('|')[1] : "";
                                                }
                                                LM_Data.KYC_Status = "FETCH_FAIL";
                                            }
                                        }

                                        try {
                                            let cond = {
                                                'Insurer_Id': ObjRequest.Insurer_Id - 0,
                                                'PB_CRN': (ObjRequest.PB_CRN === undefined || ObjRequest.PB_CRN === "" || ObjRequest.PB_CRN === null) ? "" : ObjRequest.PB_CRN - 0
//                                                'User_Data_Id': (ObjRequest.User_Data_Id === undefined || ObjRequest.User_Data_Id === "" || ObjRequest.User_Data_Id === null) ? 0 : ObjRequest.User_Data_Id - 0
                                            };
                                            let setObj = {
                                                'KYC_Number': LM_Data.KYC_Number,
                                                'KYC_Full_Name' : LM_Data.KYC_FullName,
                                                'KYC_Status': LM_Data.KYC_Status,
                                                'Modified_On': new Date(),
                                                'KYC_URL': LM_Data.KYC_Redirect_URL
                                            };
                                            kyc_detail.update(cond, {$set: setObj}, function (err, users) {
                                                if (err) {
                                                    res.json({"Insurer": "Edelweiss", "Msg": err, "Status": "FAIL"});
                                                } else {
                                                    //res.json({"Insurer": "Edelweiss", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                }
                                            });
                                            let queryObj1 = {
                                                'PB_CRN': ObjRequest.PB_CRN ? ObjRequest.PB_CRN : "",
                                                'User_Data_Id': ObjRequest.User_Data_Id ? ObjRequest.User_Data_Id : "",
                                                'Insurer_Id': ObjRequest.Insurer_Id,
                                                'Product_Id': ObjRequest.Product_Id ? ObjRequest.Product_Id : "",
                                                'PAN': (ObjRequest.PAN === undefined || ObjRequest.PAN === "" || ObjRequest.PAN === null) ? "" : ObjRequest.PAN,
                                                'Aadhar': (ObjRequest.Aadhaar === undefined || ObjRequest.Aadhaar === "" || ObjRequest.Aadhaar === null) ? "" : ObjRequest.Aadhaar,
                                                'DOB': (ObjRequest.DOB === undefined || ObjRequest.DOB === "" || ObjRequest.DOB === null) ? "" : ObjRequest.DOB,
                                                'Full_Name': ObjRequest.Proposal_Request['middle_name'] === "" ? (ObjRequest.Proposal_Request['first_name'] + " " + ObjRequest.Proposal_Request['last_name']) : (ObjRequest.Proposal_Request['first_name'] + " " + ObjRequest.Proposal_Request['middle_name'] + " " + ObjRequest.Proposal_Request['last_name']),
                                                'Mobile': (ObjRequest.Mobile === undefined || ObjRequest.Mobile === "" || ObjRequest.Mobile === null) ? "" : ObjRequest.Mobile - 0,
                                                'Email': (ObjRequest.Email === undefined || ObjRequest.Email === "" || ObjRequest.Email === null) ? "" : ObjRequest.Email,
                                                'KYC_Number': LM_Data.KYC_Number,
                                                'Search_Type': ObjRequest.Search_Type ? ObjRequest.Search_Type : "",
                                                'KYC_Status': LM_Data.KYC_Status,
                                                'PAN_Doc': ObjRequest.PAN_Doc ? ObjRequest.PAN_Doc : "",
                                                'Aadhar_Doc': ObjRequest.Aadhar_Doc ? ObjRequest.Aadhar_Doc : "",
                                                'KYC_URL': LM_Data.KYC_Redirect_URL,
                                                'Created_On': new Date(),
                                                'Modified_On': new Date(),
                                                'Proposal_Request': (ObjRequest.Proposal_Request === undefined || ObjRequest.Proposal_Request === "" || ObjRequest.Proposal_Request === null) ? "" : ObjRequest.Proposal_Request,
                                                'Proposal_Id': (ObjRequest.Proposal_Id === undefined || ObjRequest.Proposal_Id === "" || ObjRequest.Proposal_Id === null) ? "" : ObjRequest.Proposal_Id,
                                                'Quote_Id': (ObjRequest.Quote_Id === undefined || ObjRequest.Quote_Id === "" || ObjRequest.Quote_Id === null) ? "" : ObjRequest.Quote_Id,
                                                'KYC_Request_Core': kyc_fetch_request,
                                                'KYC_Response_Core': kyc_fetch_response
                                            };
                                            var kyc_history1 = new kyc_history(queryObj1);
                                            kyc_history1.save(queryObj1, function (err, users) {
                                                if (err) {
                                                    res.json({"Insurer": "Edelweiss", "Msg": err, "Status": "FAIL"});
                                                } else {
                                                    //res.json({"Insurer": "Edelweiss", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                }
                                            });
                                        } catch (e) {
                                            res.json({"Insurer": "Edelweiss", "Msg": e.stack, "Status": "FAIL"});
                                        }
                                        res.json({"Insurer": "Edelweiss", "Msg": LM_Data, "Status": LM_Data.KYC_Status});
                                    } else {
                                        res.json({"Insurer": "Edelweiss", "Msg": "KYC fetch services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                    }
                                });
                            } else {
                                res.json({"Insurer": "Edelweiss", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                            }
                        } catch (e2) {
                            res.json({"Insurer": "Edelweiss", "Msg": e2.stack, "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Edelweiss", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Edelweiss", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Edelweiss", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/edelweiss_verify_kyc_details', function (req, res) {
        try {
            let objRequest = req.body;
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            //req.body.crn = 13201;//
            //user_kyc_no = 'EGI-00000113';//
            let VISoF_KYC_Req_No = "";
            let IC_KYC_No = "";
            if (user_kyc_no === "EGI-00000113") { // for testing only
                VISoF_KYC_Req_No = "13201";
                IC_KYC_No = (objRequest.user_kyc_no === undefined || objRequest.user_kyc_no === "" || objRequest.user_kyc_no === null) ? "" : objRequest.user_kyc_no;
            } else {
                VISoF_KYC_Req_No =(objRequest.PB_CRN === undefined || objRequest.PB_CRN === "" || objRequest.PB_CRN === null) ? "" : objRequest.PB_CRN.toString();
                IC_KYC_No = (objRequest.user_kyc_no === undefined || objRequest.user_kyc_no === "" || objRequest.user_kyc_no === null) ? "" : objRequest.user_kyc_no;
            }
            let req_txt = {
                "VISoF_KYC_Req_No": VISoF_KYC_Req_No,
                "IC_KYC_No": IC_KYC_No
            };
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "*/*",
                    "Authorization": "",
                    "X-Api-Key": "vmX0qzSwUy5i4dyKa0MhuaQhQ6PECsp3FqZvwRX8"
                }
            };
            let args1 = {
                headers: {
                    "Authorization": 'Basic ' + new Buffer('2r9a4a9lpvj2lp5bqbo0jhcp0l' + ':' + '1q0fbp68juvm8f221f9ckh9j7i3ktq2hkibfk88q460pvccsfmqs').toString('base64'),
                    //"Authorization": "Basic MnI5YTRhOWxwdmoybHA1YnFibzBqaGNwMGw6MXEwZmJwNjhqdXZtOGYyMjFmOWNraDlqN2kza3RxMmhraWJmazg4cTQ2MHB2Y2NzZm1xcw==",
                    "Content-Type": "application/x-www-form-urlencoded",
                    "Accept": "*/*"
                }
            };
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.post("https://devapi.edelweissinsurance.com/oauth2/token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("access_token") && data1.access_token !== "" && data1.access_token !== null) {
                        token = data1.access_token;
                        try {
                            if (token) {
                                args.headers.Authorization = token;
                                var client1 = new Client();
                                client1.get("https://devapi.edelweissinsurance.com/signzy/e-kyc-enquiry", args, function (data, response) {
                                    if (data) {
                                        let LM_Data = {
                                            'KYC_Obj': {
                                                'KYC_Number': ''
                                            },
                                            'LM_Obj': {
                                                'iskycVerified': '',
                                                'redirect_link': '',
                                                'status': ''
                                            },
                                            'Edelweiss_Obj': {
                                                'data': ''
                                            },
                                            'tmp_Obj': ''
                                        };
                                        if (data.hasOwnProperty("message") && data.message !== "") {
                                            KYC_Status = "PENDING"; //rosh
                                            LM_Data.Edelweiss_Obj.data = data.message;
                                            LM_Data.tmp_Obj = LM_Data.Edelweiss_Obj.data;
                                        } else {
                                            if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data) {
                                                if (data.data.hasOwnProperty("KYC_Status") && (data.data.KYC_Status === '1' || data.data.KYC_Status === 1)) {
                                                    if ((data.data.hasOwnProperty("VISoF_KYC_Req_No") && data.data.VISoF_KYC_Req_No !== "") && (data.data.hasOwnProperty("IC_KYC_No") && data.data.IC_KYC_No !== "")) {
                                                        kyc_id = data.data.VISoF_KYC_Req_No + "|" + data.data.IC_KYC_No;
                                                        KYC_Status = "VERIFIED";
                                                        LM_Data.KYC_Obj.KYC_Number = kyc_id;
                                                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                    } else {
                                                        KYC_Status = "PENDING"; //rosh
                                                        LM_Data.Edelweiss_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Edelweiss_Obj.data;
                                                    }
                                                } else {
                                                    KYC_Status = "PENDING"; //rosh
                                                    LM_Data.LM_Obj.iskycVerified = data.data.KYC_Status;
                                                    LM_Data.LM_Obj.status = data.data.KYC_Remark;
                                                    LM_Data.LM_Obj.redirect_link = data.data.IC_KYC_REG_URL;
                                                    LM_Data.tmp_Obj = LM_Data.LM_Obj;
                                                }
                                            } else {
                                                KYC_Status = "PENDING"; //rosh
                                                LM_Data.Edelweiss_Obj.data = data.message;
                                                LM_Data.tmp_Obj = LM_Data.Edelweiss_Obj.data;
                                            }
                                        }

                                        try {
                                            let queryObj = {
//                                                'Insurer_Id': objRequest.Insurer_Id - 0,
                                                'Search_Type': (objRequest.Verify_Search_Type === undefined || objRequest.Verify_Search_Type === "" || objRequest.Verify_Search_Type === null) ? "" : objRequest.Verify_Search_Type,
                                                'KYC_Number': user_kyc_no,
//                                                'Mobile': (objRequest.Mobile === undefined || objRequest.Mobile === "" || objRequest.Mobile === null) ? "" : objRequest.Mobile - 0,
//                                                'PAN': (objRequest.PAN === undefined || objRequest.PAN === "" || objRequest.PAN === null) ? "" : objRequest.PAN,
//                                                'Aadhar': (objRequest.Aadhar === undefined || objRequest.Aadhar === "" || objRequest.Aadhar === null) ? "" : objRequest.Aadhar,
                                                'KYC_Status': KYC_Status,
//                                                'DOB': (objRequest.DOB === undefined || objRequest.DOB === "" || objRequest.DOB === null) ? "" : objRequest.DOB,
//                                                'Created_On': new Date(),
                                                'Modified_On': new Date()
//                                                'User_Data_Id': (objRequest.User_Data_Id === undefined || objRequest.User_Data_Id === "" || objRequest.User_Data_Id === null) ? 0 : objRequest.User_Data_Id - 0,
//                                                'Product_Id': (objRequest.Product_Id === undefined || objRequest.Product_Id === "" || objRequest.Product_Id === null) ? 0 : objRequest.Product_Id - 0,
//                                                'Email': (objRequest.Email === undefined || objRequest.Email === "" || objRequest.Email === null) ? "" : objRequest.Email,
//                                                'PB_CRN': (objRequest.PB_CRN === undefined || objRequest.PB_CRN === "" || objRequest.PB_CRN === null) ? "" : objRequest.PB_CRN - 0
                                            };
                                            let cond = {
                                                'Insurer_Id': objRequest.Insurer_Id - 0,
                                                'PB_CRN': (objRequest.PB_CRN === undefined || objRequest.PB_CRN === "" || objRequest.PB_CRN === null) ? "" :objRequest.PB_CRN - 0,
                                                'User_Data_Id': (objRequest.User_Data_Id === undefined || objRequest.User_Data_Id === "" || objRequest.User_Data_Id === null) ? 0 : objRequest.User_Data_Id - 0
                                            };
                                            //var kyc_detail1 = new kyc_detail(queryObj);
                                            kyc_detail.update(cond, {$set: queryObj}, function (err, users) {
                                                if (err) {
                                                    res.json({"Insurer": "Edelweiss", "Msg": err, "Status": "FAIL"});
                                                } else {
                                                    //res.json({"Insurer": "Edelweiss", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                }
                                            });
                                            let queryObj1 = {
                                                'PB_CRN': (objRequest.PB_CRN === undefined || objRequest.PB_CRN === "" || objRequest.PB_CRN === null) ? "" : objRequest.PB_CRN - 0,
                                                'User_Data_Id': (objRequest.User_Data_Id === undefined || objRequest.User_Data_Id === "" || objRequest.User_Data_Id === null) ? 0 : objRequest.User_Data_Id - 0,
                                                'PAN': (objRequest.PAN === undefined || objRequest.PAN === "" || objRequest.PAN === null) ? "" : objRequest.PAN,
                                                'Aadhaar': (objRequest.Aadhaar === undefined || objRequest.Aadhaar === "" || objRequest.Aadhaar === null) ? "" : objRequest.Aadhaar,
                                                'DOB': (objRequest.DOB === undefined || objRequest.DOB === "" || objRequest.DOB === null) ? "" : objRequest.DOB,
                                                'Mobile': (objRequest.Mobile === undefined || objRequest.Mobile === "" || objRequest.Mobile === null) ? "" : objRequest.Mobile - 0,
                                                'Email': (objRequest.Email === undefined || objRequest.Email === "" || objRequest.Email === null) ? "" : objRequest.Email,
                                                'Insurer_Id': objRequest.Insurer_Id - 0,
                                                'KYC_Request_Core': req_txt,
                                                'KYC_Response_Core': data,
                                                'Status': "completed",
                                                'Created_On': new Date(),
                                                'Modified_On': new Date()
                                            };
                                            var kyc_history1 = new kyc_history(queryObj1);
                                            kyc_history1.save(queryObj1, function (err, users) {
                                                if (err) {
                                                    res.json({"Insurer": "Edelweiss", "Msg": err, "Status": "FAIL"});
                                                } else {
                                                    //res.json({"Insurer": "Edelweiss", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                }
                                            });
                                        } catch (e) {
                                            res.json({"Insurer": "Edelweiss", "Msg": e.stack, "Status": "FAIL"});
                                        }
                                        res.json({"Insurer": "Edelweiss", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                    } else {
                                        res.json({"Insurer": "Edelweiss", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                    }
                                });
                            } else {
                                res.json({"Insurer": "Edelweiss", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                            }
                        } catch (e2) {
                            res.json({"Insurer": "Edelweiss", "Msg": e2.stack, "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Edelweiss", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Edelweiss", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Edelweiss", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/royal_fetch_kyc_details', function (req, res) {
        try {
            let req_txt = {
                "mobile": (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                "name": "",
                "kyc_id": "",
                "dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                "ckyc_number": "",
                "pan": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                "aadhaar_uid": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : (req.body.aadhar.substr(req.body.aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": "",
                "redirect_url": ""
            };
            req_txt = {
                "token": "//YLUdYEvCYSo8z+Ju42aMNVwBrB/NivkS1bNapab8uYCyZFEy2UK7K7BOvl0Val",
                "policyNo ": "",
                "quoteNo": "BA508116VMN0392433",
                "inwardNo": "",
                "appName": "D2C",
                "proposalNo": "",
                "product": "Privatecar",
                "Lob": "",
                "customerName": "",
                "mobileNo": "9XXXXXXXXX",
                "emailId": "XXXXXXX",
                "address1": "",
                "address2": "",
                "address3": "",
                "address4": "",
                "State": "",
                "City": "",
                "pinCode": "",
                "ckycNo": "",
                "panNumber": "XXXXXXXXX",
                "aadharNumber": "",
                "dateOfBirth": "XX/XX/XXXXX",
                "eiaNumber": "",
                "customerType": "Individual",
                "gender": "",
                "drivingLincense": "",
                "passportNumber": "",
                "voterId": "",
                "userName": "",
                "uniqueId": "BA508116VMN0392433",
                "returnURL": ""
            };
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "*/*"
                }
            };
            let args1 = {
                data: {
                    "appId": "D2C",
                    "appKey": "D2C"
                },
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "*/*"
                }
            };
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.post("https://ekyc.royalsundaram.net/eKycServices/ekyc/generateKYCToken", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("errorMsg") && data1.errorMsg === "null") {
                        if (data1.hasOwnProperty("token") && data1.token !== "" && data1.token !== null) {
                            token = data1.token;
                            try {
                                if (token) {
                                    var client1 = new Client();
                                    client1.post("https://ekyc.royalsundaram.net/eKycServices/ekyc/v1/searchDownloadKYCDetails", args, function (data, response) {
                                        if (data) {
                                            if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                if (data.data.iskycVerified === 1) {
                                                    kyc_id = (data.data.hasOwnProperty("kyc_id")) ? data.data.kyc_id : "";
                                                    KYC_Status = "SUCCESS";
                                                } else if (data.data.iskycVerified === 0) {
                                                    kyc_id = (data.data.hasOwnProperty("redirect_link")) ? data.data.redirect_link : "";
                                                    KYC_Status = "FAIL";
                                                } else {
                                                    KYC_Status = "FAIL";
                                                }
                                            } else {
                                                KYC_Status = "FAIL";
                                            }

                                            try {
                                                let queryObj = {
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                                                    'KYC_Number': kyc_id,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'KYC_Status': KYC_Status,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date(),
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                                                };
                                                var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail1.save(queryObj, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Royal", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Royal", "Msg": data.data, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Royal", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Royal", "Msg": data.data, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "Royal", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "Royal", "Msg": data.data, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "Royal", "Msg": "KYC fetch services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "Royal", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "Royal", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "Royal", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Royal", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Royal", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Royal", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/royal_verify_kyc_details', function (req, res) {
        try {
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            var user_name = null;
            if (req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            } else {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) ? "" : req.body.middle_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            }
            let req_txt = {
                "mobile": (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                "name": user_name,
                "kyc_id": user_kyc_no,
                "dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                "ckyc_number": user_kyc_no,
                "pan": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                "aadhaar_uid": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : (req.body.aadhar.substr(req.body.aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                "redirect_url": ""
            };
            let args = {headers: {"token": ""}};
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            var Client = require('node-rest-client').Client;
            var client1 = new Client();
            client1.post("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-status/" + user_kyc_no, args, function (data, response) {
                if (data) {
                    let LM_Data = {
                        'KYC_Obj': {
                            'kyc_id': ''
                        },
                        'LM_Obj': {
                            'iskycVerified': '',
                            'redirect_link': '',
                            'status': ''
                        },
                        'Hdfc_Obj': {
                            'data': ''
                        },
                        'tmp_Obj': ''
                    };
                    if (data.hasOwnProperty("message") && data.message !== "") {
                        KYC_Status = "FAIL";
                        LM_Data.Hdfc_Obj.data = data.message;
                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                    } else {
                        if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                            if (data.data.iskycVerified === 1) {
                                KYC_Status = "SUCCESS";
                                LM_Data.KYC_Obj.kyc_id = user_kyc_no;
                                LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                            } else if (data.data.iskycVerified === 0) {
                                KYC_Status = "FAIL";
                                LM_Data.Hdfc_Obj.data = data;
                                LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                            } else {
                                KYC_Status = "FAIL";
                                LM_Data.Hdfc_Obj.data = data;
                                LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                            }
                        } else {
                            KYC_Status = "FAIL";
                            LM_Data.Hdfc_Obj.data = data;
                            LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                        }
                    }

                    try {
                        //data.data.Msg.kyc_id = user_kyc_no;
                        let queryObj = {
                            'Insurer_Id': req.body.insurer_id,
                            'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                            'KYC_Number': user_kyc_no,
                            'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'KYC_Status': KYC_Status,
                            'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                            'Created_On': new Date(),
                            'Modified_On': new Date(),
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                            'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                        };
                        var kyc_detail1 = new kyc_detail(queryObj);
                        kyc_detail1.save(queryObj, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "Royal", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "Royal", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                            }
                        });
                        let queryObj1 = {
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                            'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                            'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                            'Insurer_Id': req.body.insurer_id,
                            'KYC_Request_Core': req_txt,
                            'KYC_Response_Core': data,
                            'Status': "completed",
                            'Created_On': new Date(),
                            'Modified_On': new Date()
                        };
                        var kyc_history1 = new kyc_history(queryObj1);
                        kyc_history1.save(queryObj1, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "Royal", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "Royal", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                            }
                        });
                    } catch (e) {
                        res.json({"Insurer": "Royal", "Msg": e.stack, "Status": "FAIL"});
                    }
                    res.json({"Insurer": "Royal", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                } else {
                    res.json({"Insurer": "Royal", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Royal", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/bajaj_fetch_kyc_details', function (req, res) {
        try {
            let req_txt = {
                "mobile": (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                "name": "",
                "kyc_id": "",
                "dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                "ckyc_number": "",
                "pan": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                "aadhaar_uid": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : (req.body.aadhar.substr(req.body.aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": "",
                "redirect_url": ""
            };
            let vehicle_registration_type = (req.body.vehicle_registration_type === undefined || req.body.vehicle_registration_type === "" || req.body.vehicle_registration_type === null) ? "" : req.body.vehicle_registration_type;
            vehicle_registration_type = (req.body.vehicle_registration_type === "") ? "" : (req.body.vehicle_registration_type === "corporate" ? "O" : "I");
            req_txt = {
                "docTypeCode": "Z",
                "docNumber": "50088195443815", //kyc_no for verify
                "fieldType": "PROPOSAL_NUMBER", //fixed
                "fieldValue": "12345678678",
                "dob": "08-Nov-2004", //08-Nov-2004
                "appType": "KYC_WS_BROKER", //fixed
                "productCode": "3313",
                "sysType": "MAXIMUS", //-Motor, Health/Travel-"MAXIMUS",
                "locationCode": "9906",
                "userId": "CP02529865",
                "kycType": "03", //fixed
                "customerType": vehicle_registration_type, //"I-Individual, O - Organization"
                "passportFileNumber": "",
                "gender": "",
                "field1": "",
                "field2": ""
            };
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    "token": ""
                }
            };
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.get("https://ctrln-uat.hdfcergo.com/e-kyc/tgt/generate-token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("success") && data1.success === true) {
                        if (data1.hasOwnProperty("data") && data1.data.hasOwnProperty("token") && data1.data.token !== "" && data1.data.token !== null) {
                            token = data1.data.token;
                            try {
                                if (token) {
                                    args.headers.token = token;
                                    var client1 = new Client();
                                    client1.get("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-verified", args, function (data, response) {
                                        if (data) {
                                            if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                if (data.data.iskycVerified === 1) {
                                                    kyc_id = (data.data.hasOwnProperty("kyc_id")) ? data.data.kyc_id : "";
                                                    KYC_Status = "SUCCESS";
                                                } else if (data.data.iskycVerified === 0) {
                                                    kyc_id = (data.data.hasOwnProperty("redirect_link")) ? data.data.redirect_link : "";
                                                    KYC_Status = "FAIL";
                                                } else {
                                                    KYC_Status = "FAIL";
                                                }
                                            } else {
                                                KYC_Status = "FAIL";
                                            }

                                            try {
                                                let queryObj = {
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                                                    'KYC_Number': kyc_id,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'KYC_Status': KYC_Status,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date(),
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                                                };
                                                var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail1.save(queryObj, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Bajaj", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Bajaj", "Msg": data.data, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Bajaj", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Bajaj", "Msg": data.data, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "Bajaj", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "Bajaj", "Msg": data.data, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "Bajaj", "Msg": "KYC fetch services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "Bajaj", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "Bajaj", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "Bajaj", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Bajaj", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Bajaj", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Bajaj", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/bajaj_verify_kyc_details', function (req, res) {
        try {
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            var user_name = null;
            if (req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            } else {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) ? "" : req.body.middle_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            }
            let req_txt = {
                "mobile": (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                "name": user_name,
                "kyc_id": user_kyc_no,
                "dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                "ckyc_number": user_kyc_no,
                "pan": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                "aadhaar_uid": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : (req.body.aadhar.substr(req.body.aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                "redirect_url": ""
            };

            let args = {headers: {"token": ""}};
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.get("https://ctrln-uat.hdfcergo.com/e-kyc/tgt/generate-token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("success") && data1.success === true) {
                        if (data1.hasOwnProperty("data") && data1.data.hasOwnProperty("token") && data1.data.token !== "" && data1.data.token !== null) {
                            token = data1.data.token;
                            try {
                                if (token) {
                                    args.headers.token = token;
                                    var client1 = new Client();
                                    client1.get("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-status/" + user_kyc_no, args, function (data, response) {
                                        if (data) {
                                            let LM_Data = {
                                                'KYC_Obj': {
                                                    'kyc_id': ''
                                                },
                                                'LM_Obj': {
                                                    'iskycVerified': '',
                                                    'redirect_link': '',
                                                    'status': ''
                                                },
                                                'Hdfc_Obj': {
                                                    'data': ''
                                                },
                                                'tmp_Obj': ''
                                            };
                                            if (data.hasOwnProperty("message") && data.message !== "") {
                                                KYC_Status = "FAIL";
                                                LM_Data.Hdfc_Obj.data = data.message;
                                                LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                            } else {
                                                if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                    if (data.data.iskycVerified === 1) {
                                                        KYC_Status = "SUCCESS";
                                                        LM_Data.KYC_Obj.kyc_id = user_kyc_no;
                                                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                    } else if (data.data.iskycVerified === 0) {
                                                        KYC_Status = "FAIL";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    } else {
                                                        KYC_Status = "FAIL";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    }
                                                } else {
                                                    KYC_Status = "FAIL";
                                                    LM_Data.Hdfc_Obj.data = data;
                                                    LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                }
                                            }

                                            try {
                                                //data.data.Msg.kyc_id = user_kyc_no;
                                                let queryObj = {
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                                                    'KYC_Number': user_kyc_no,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'KYC_Status': KYC_Status,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date(),
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                                                };
                                                var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail1.save(queryObj, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Bajaj", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Bajaj", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Bajaj", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Bajaj", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "Bajaj", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "Bajaj", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "Bajaj", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "Bajaj", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "Bajaj", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "Bajaj", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Bajaj", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Bajaj", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Bajaj", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/bajaj_encrypting', function (req, res) {
        try {
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            var user_name = null;
            if (req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            } else {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) ? "" : req.body.middle_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            }
            let req_txt = {
                "mobile": (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                "name": user_name,
                "kyc_id": user_kyc_no,
                "dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                "ckyc_number": user_kyc_no,
                "pan": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                "aadhaar_uid": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : (req.body.aadhar.substr(req.body.aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                "redirect_url": ""
            };

            let args = {headers: {"token": ""}};
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.get("https://ctrln-uat.hdfcergo.com/e-kyc/tgt/generate-token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("success") && data1.success === true) {
                        if (data1.hasOwnProperty("data") && data1.data.hasOwnProperty("token") && data1.data.token !== "" && data1.data.token !== null) {
                            token = data1.data.token;
                            try {
                                if (token) {
                                    args.headers.token = token;
                                    var client1 = new Client();
                                    client1.get("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-status/" + user_kyc_no, args, function (data, response) {
                                        if (data) {
                                            let LM_Data = {
                                                'KYC_Obj': {
                                                    'kyc_id': ''
                                                },
                                                'LM_Obj': {
                                                    'iskycVerified': '',
                                                    'redirect_link': '',
                                                    'status': ''
                                                },
                                                'Hdfc_Obj': {
                                                    'data': ''
                                                },
                                                'tmp_Obj': ''
                                            };
                                            if (data.hasOwnProperty("message") && data.message !== "") {
                                                KYC_Status = "FAIL";
                                                LM_Data.Hdfc_Obj.data = data.message;
                                                LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                            } else {
                                                if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                    if (data.data.iskycVerified === 1) {
                                                        KYC_Status = "SUCCESS";
                                                        LM_Data.KYC_Obj.kyc_id = user_kyc_no;
                                                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                    } else if (data.data.iskycVerified === 0) {
                                                        KYC_Status = "FAIL";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    } else {
                                                        KYC_Status = "FAIL";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    }
                                                } else {
                                                    KYC_Status = "FAIL";
                                                    LM_Data.Hdfc_Obj.data = data;
                                                    LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                }
                                            }

                                            try {
                                                //data.data.Msg.kyc_id = user_kyc_no;
                                                let queryObj = {
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                                                    'KYC_Number': user_kyc_no,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'KYC_Status': KYC_Status,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date(),
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                                                };
                                                var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail1.save(queryObj, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Bajaj", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Bajaj", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Bajaj", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Bajaj", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "Bajaj", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "Bajaj", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "Bajaj", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "Bajaj", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "Bajaj", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "Bajaj", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Bajaj", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Bajaj", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Bajaj", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/liberty_fetch_kyc_details', function (req, res) {
        try {
            let vehicle_registration_type = (req.body.vehicle_registration_type === undefined || req.body.vehicle_registration_type === "" || req.body.vehicle_registration_type === null) ? "" : req.body.vehicle_registration_type;
            vehicle_registration_type = (vehicle_registration_type === "") ? "" : (vehicle_registration_type === "corporate" ? "C" : "I");
            let req_txt = {
                "Aggregator_Program_Name": "PolicyBossLandmark",
                "Aggregator_KYC_Req_No": "PolicyBossLandmark000001",
                "ProposerType": vehicle_registration_type, //(I-Individual, C-Corporate)
                "FirstName": (req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name, //"MR ANAND",
                "MiddleName": (req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) ? "" : req.body.middle_name,
                "LastName": (req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name,
                "CompanyName": "",
                "Gender": "", //"M",
                "DOB": "", //"28-02-1986",
                "DOI": "",
                "MobileNo": "",
                "Email": "",
                "ProposerPAN": "", //"AMLPV9010E",
                "ProposerAadhaarNumber": "",
                "ProposerCKYCNo": "",
                "Other_Add_FLD1": "",
                "Other_Add_FLD2": "",
                "Other_Add_FLD3": "",
                "Other_Add_FLD4": "",
                "Other_Add_FLD5": "",
                "Other_Add_FLD6": ""
            };
            let buff_enc = new Buffer(JSON.stringify(req_txt));
            let data_enc = buff_enc.toString('base64');
            let req_txt_base64 = {
                "enc_request": data_enc
            };
            let args = {
                data: req_txt_base64,
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "*/*"
                }
            };

            /*
             let data = 'c3RhY2thYnVzZS5jb20=';
             let buff = new Buffer(data, 'base64');
             let text = buff.toString('utf8');
             console.log('"' + data + '" converted from Base64 to utf8 is "' + text + '"');
             console.log("==========   ==========");
             let data1 = 'stackabuse.com';
             let buff1 = new Buffer(data1);
             let base64data1 = buff1.toString('base64');
             console.log('"' + data1 + '" converted to Base64 is "' + base64data1 + '"');
             */

            let KYC_Status = "PENDING";
            let kyc_id = 0;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.post("https://moem-uat.libertyinsurance.in/ckyc/api/Generic/VerifyKYC", args, function (data, response) {
                if (data) {

                    let buff_dec = new Buffer(data, 'base64');
                    let data_dec = buff_dec.toString('ascii');
                    console.log(data_dec);
                    if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                        if (data.data.iskycVerified === 1) {
                            kyc_id = (data.data.hasOwnProperty("kyc_id")) ? data.data.kyc_id : "";
                            KYC_Status = "SUCCESS";
                        } else if (data.data.iskycVerified === 0) {
                            kyc_id = (data.data.hasOwnProperty("redirect_link")) ? data.data.redirect_link : "";
                            KYC_Status = "FAIL";
                        } else {
                            KYC_Status = "FAIL";
                        }
                    } else {
                        KYC_Status = "FAIL";
                    }

                    try {
                        let queryObj = {
                            'Insurer_Id': req.body.insurer_id,
                            'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                            'KYC_Number': kyc_id,
                            'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'KYC_Status': KYC_Status,
                            'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                            'Created_On': new Date(),
                            'Modified_On': new Date(),
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                            'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                        };
                        var kyc_detail1 = new kyc_detail(queryObj);
                        kyc_detail1.save(queryObj, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "Liberty", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "Liberty", "Msg": data.data, "Status": KYC_Status});
                            }
                        });
                        let queryObj1 = {
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                            'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                            'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                            'Insurer_Id': req.body.insurer_id,
                            'KYC_Request_Core': req_txt,
                            'KYC_Response_Core': data,
                            'Status': "completed",
                            'Created_On': new Date(),
                            'Modified_On': new Date()
                        };
                        var kyc_history1 = new kyc_history(queryObj1);
                        kyc_history1.save(queryObj1, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "Liberty", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "Liberty", "Msg": data.data, "Status": KYC_Status});
                            }
                        });
                    } catch (e) {
                        res.json({"Insurer": "Liberty", "Msg": e.stack, "Status": "FAIL"});
                    }
                    res.json({"Insurer": "Liberty", "Msg": data.data, "Status": KYC_Status});
                } else {
                    res.json({"Insurer": "Liberty", "Msg": "KYC fetch services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });

        } catch (e1) {
            res.json({"Insurer": "Liberty", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/liberty_verify_kyc_details', function (req, res) {
        try {
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            var user_name = null;
            if (req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            } else {
                user_name = ((req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name) + " " +
                        ((req.body.middle_name === undefined || req.body.middle_name === "" || req.body.middle_name === null) ? "" : req.body.middle_name) + " " +
                        ((req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name);
            }
            let req_txt = {
                "mobile": (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                "name": user_name,
                "kyc_id": user_kyc_no,
                "dob": (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                "ckyc_number": user_kyc_no,
                "pan": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                "aadhaar_uid": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : (req.body.aadhar.substr(req.body.aadhar.length - 4)), //"last 4 digits of aadhar",
                "agent_id": "",
                "gc_cust_id": "",
                "eia_number": "",
                "email_address": (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                "redirect_url": ""
            };
            req_txt = {
                "Aggregator_KYC_Req_No": user_kyc_no,
                "IC_KYC_No ": user_kyc_no,
                "Aggregator_Return_URL": "",
                "Other_Add_FLD1": "",
                "Other_Add_FLD2": "",
                "Other_Add_FLD3": "",
                "Other_Add_FLD4": "",
                "Other_Add_FLD5": "",
                "Other_Add_FLD6": ""
            };
            let args = {headers: {"token": ""}};
            let args1 = {
                headers: {
                    "api_key": "8d399be8-0b6f-4a"
                }
            };
            let KYC_Status = "PENDING";
            let token = null;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.get("https://ctrln-uat.hdfcergo.com/e-kyc/tgt/generate-token", args1, function (data1, response1) {
                if (data1) {
                    if (data1.hasOwnProperty("success") && data1.success === true) {
                        if (data1.hasOwnProperty("data") && data1.data.hasOwnProperty("token") && data1.data.token !== "" && data1.data.token !== null) {
                            token = data1.data.token;
                            try {
                                if (token) {
                                    args.headers.token = token;
                                    var client1 = new Client();
                                    client1.get("https://ctrln-uat.hdfcergo.com/e-kyc/primary/kyc-status/" + user_kyc_no, args, function (data, response) {
                                        if (data) {
                                            let LM_Data = {
                                                'KYC_Obj': {
                                                    'kyc_id': ''
                                                },
                                                'LM_Obj': {
                                                    'iskycVerified': '',
                                                    'redirect_link': '',
                                                    'status': ''
                                                },
                                                'Hdfc_Obj': {
                                                    'data': ''
                                                },
                                                'tmp_Obj': ''
                                            };
                                            if (data.hasOwnProperty("message") && data.message !== "") {
                                                KYC_Status = "FAIL";
                                                LM_Data.Hdfc_Obj.data = data.message;
                                                LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                            } else {
                                                if (data.hasOwnProperty("success") && data.success === true && data.hasOwnProperty("data") && data.data.hasOwnProperty("iskycVerified")) {
                                                    if (data.data.iskycVerified === 1) {
                                                        KYC_Status = "SUCCESS";
                                                        LM_Data.KYC_Obj.kyc_id = user_kyc_no;
                                                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                    } else if (data.data.iskycVerified === 0) {
                                                        KYC_Status = "FAIL";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    } else {
                                                        KYC_Status = "FAIL";
                                                        LM_Data.Hdfc_Obj.data = data;
                                                        LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                    }
                                                } else {
                                                    KYC_Status = "FAIL";
                                                    LM_Data.Hdfc_Obj.data = data;
                                                    LM_Data.tmp_Obj = LM_Data.Hdfc_Obj.data;
                                                }
                                            }

                                            try {
                                                //data.data.Msg.kyc_id = user_kyc_no;
                                                let queryObj = {
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                                                    'KYC_Number': user_kyc_no,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'KYC_Status': KYC_Status,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date(),
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                                                };
                                                var kyc_detail1 = new kyc_detail(queryObj);
                                                kyc_detail1.save(queryObj, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Liberty", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Liberty", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                                let queryObj1 = {
                                                    'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                                                    'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                    'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                    'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                    'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                    'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                    'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                    'Insurer_Id': req.body.insurer_id,
                                                    'KYC_Request_Core': req_txt,
                                                    'KYC_Response_Core': data,
                                                    'Status': "completed",
                                                    'Created_On': new Date(),
                                                    'Modified_On': new Date()
                                                };
                                                var kyc_history1 = new kyc_history(queryObj1);
                                                kyc_history1.save(queryObj1, function (err, users) {
                                                    if (err) {
                                                        res.json({"Insurer": "Liberty", "Msg": err, "Status": "FAIL"});
                                                    } else {
                                                        //res.json({"Insurer": "Liberty", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                    }
                                                });
                                            } catch (e) {
                                                res.json({"Insurer": "Liberty", "Msg": e.stack, "Status": "FAIL"});
                                            }
                                            res.json({"Insurer": "Liberty", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                        } else {
                                            res.json({"Insurer": "Liberty", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                        }
                                    });
                                } else {
                                    res.json({"Insurer": "Liberty", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                                }
                            } catch (e2) {
                                res.json({"Insurer": "Liberty", "Msg": e2.stack, "Status": "FAIL"});
                            }
                        } else {
                            res.json({"Insurer": "Liberty", "Msg": "KYC-Token not generated. Please try again later.", "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "Liberty", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "Liberty", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "Liberty", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.get('/kyc_details/get_kyc_status_NIU/:crn/:udid', function (req, res) {
        try {
            let crn = req.params.crn - 0;
            let udid = req.params.udid - 0;
            let kyc_detail = require('../models/kyc_detail');
            kyc_detail.findOne({'PB_CRN': crn, 'User_Data_Id': udid}).sort({Modified_On:-1}).exec(function (err, data) {
                if (err) {
                    res.json({"Msg": err, "Status": "FAIL"});
                } else {
                    if (data) {
                        res.json({"Msg": data['_doc'], "Status": data['_doc'].KYC_Status});
                    } else {
                       res.json({"Msg": "No Data Available", "Status": "NEW"});
                    }
                }
            });
        } catch (err) {
            res.json({"Msg": err.stack, "Status": "FAIL"});
        }
    });
    app.get('/kyc_details/get_kyc_status/:crn/:insurer_id', function (req, res) {
        try {
            let crn = req.params.crn - 0;
            let insurer_id = req.params.insurer_id - 0;
            let kyc_detail = require('../models/kyc_detail');
            kyc_detail.findOne({'PB_CRN': crn, 'Insurer_Id': insurer_id}).sort({Modified_On: -1}).exec(function (err, data) {
                if (err) {
                    res.json({"Msg": err, "Status": "FAIL"});
                } else {
                    if (data) {
                        res.json({"Msg": data['_doc'], "Status": data['_doc'].KYC_Status});
                    } else {
                        res.json({"Msg": "No Data Available", "Status": "NEW"});
                    }
                }
            });
        } catch (err) {
            res.json({"Msg": err.stack, "Status": "FAIL"});
        }
    });
    app.get('/kyc_details/verify_scheduler', function (req, res, next) {
        var Client = require('node-rest-client').Client;
        var client = new Client();
        let data_count = 0;
        kyc_detail.find({KYC_Status: 'FAIL'}).exec(function (err, dbRequest) {
            if (err)
                res.send("Error :" + err.stack);
            if (dbRequest.length > 0) {
                let objCallSummary = {
                    'main': {
                        'total_job': dbRequest.length,
                        'success_job_cnt': 0,
                        'fail_job_cnt': 0,
                        'verified_status_cnt': 0,
                        'pending_status_cnt': 0
                    },
                    'success_job': [],
                    'fail_job': [],
                    'verified_job': [],
                    'pending_job': []
                };

                let service_method_url = config.environment.weburl + "/postservicecall/kyc_details/search_kyc_details";
                for (let i in dbRequest) {
                    data_count++;
                    let arg_obj = dbRequest[i]['_doc'];
                    let args = {
                        data: {
                            "search_type": "VERIFY",
                            "pan": arg_obj['PAN'],
                            "dob": arg_obj['DOB'],
                            "insurer_id": arg_obj['Insurer_Id'] - 0,
                            "crn": arg_obj['PB_CRN'] - 0,
                            "user_kyc_no": "",
                            "udid": 270228 - 0,
                            "product_id": 1 - 0,
                            "secret_key": "SECRET-HZ07QRWY-JIBT-XRMQ-ZP95-J0RWP3DYRACW",
                            "client_key": "CLIENT-CNTP6NYE-CU9N-DUZW-CSPI-SH1IS4DOVHB9"
                        },
                        headers: {
                            "Content-Type": "application/json"
                        }
                    };
                    try {
                        client.post(service_method_url, args, function (data, response) {
                            if (data.Status === 'Success') {
                                objCallSummary.main.success_job_cnt++;
                                objCallSummary.success_job.push(data.Summary);
                                if (data.MSG === "Verify") {
                                    objCallSummary.main.verified_status_cnt++;
                                    objCallSummary.verified_job.push(data.Summary);
                                } else {
                                    objCallSummary.main.pending_status_cnt++;
                                    objCallSummary.pending_job.push(data.Summary);
                                }
                            } else {
                                objCallSummary.main.fail_job_cnt++;
                                var SummaryErr = {
                                    'url': service_method_url,
                                    'err': data,
                                    'status': 'api_failed'
                                };
                                objCallSummary.fail_job.push(SummaryErr);
                            }
                        });
                    } catch (ex) {
                        var SummaryErr = {
                            'url': service_method_url,
                            'err': ex.stack,
                            'status': 'api_exception'
                        };
                        console.error('Exception', 'post_call_error', ex.stack);
                        objCallSummary.fail_job.push(SummaryErr);
                    }
                    if (i === dbRequest.length - 1) {
                        res.send(objCallSummary);
                    }
                }
            } else {
                res.send("Record Not found for verify KYC");
            }
        });
    });
    
    app.post('/kyc_details/tataaig_fetch_kyc_details', function (req, res) {
        try {
            let ObjRequest = req.body;
            let proposal_request = ObjRequest.Proposal_Request;
            let tokenservice_url = ((config.environment.name !== 'Production') ? 'https://uatapigw-tataaig.auth.ap-south-1.amazoncognito.com/oauth2/token' : '');
            let grant_type = ((config.environment.name !== 'Production') ? 'client_credentials' : '');
            let scope = ((config.environment.name !== 'Production') ? 'https://api.iorta.in/write' : '');
            let client_id = ((config.environment.name !== 'Production') ? '5qdbqng8plqp1ko2sslu695n2g' : '');
            let client_secret = ((config.environment.name !== 'Production') ? 'gki6eqtltmjj37gpqq0dt52dt651o079dn6mls62ptkvsa2b45c' : '');
            let token_args = {
                "grant_type": grant_type,
                "scope": scope,
                "client_id": client_id,
                "client_secret": client_secret
            };
            let kyc_token_args = {
                data: token_args,
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                }
            };
            function jsonToQueryString(json) {
                return  Object.keys(json).map(function (key) {
                    return encodeURIComponent(key) + '=' +
                            encodeURIComponent(json[key]);
                }).join('&');
            }
            kyc_token_args.data = jsonToQueryString(kyc_token_args.data);
            let full_name = proposal_request['middle_name'] === "" ? (proposal_request['first_name'] + " " + proposal_request['last_name']) : (proposal_request['first_name'] + " " + proposal_request['middle_name'] + " " + proposal_request['last_name']);
            let product_name_obj = {1: "motor", 10: "motor", 12: "motor", 2: "", 4: "travel"};
            let product_name = product_name_obj[ObjRequest.product_id];
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            let token = null;
            let Client = require('node-rest-client').Client;
            let client = new Client();
            let user_datas = {};
            client.post(tokenservice_url, kyc_token_args, function (token_data, response1) {
                if (token_data) {
                    if (token_data.hasOwnProperty("access_token") && token_data.access_token) {
                        token = token_data.access_token;
                        try {
                            if (token) {
                                client.get(config.environment.weburl + '/user_datas/view/' + req.body.User_Data_Id, {}, function (db_user_data, response) {
                                    if (db_user_data) {
                                        user_datas = db_user_data[0];
                                        let objProduct = {
                                            "Quote_Id": user_datas['Processed_Request']['___insurer_customer_identifier___'],
                                            "Modified_On": new Date()
                                        };
                                        kyc_detail.update({"PB_CRN": user_datas['PB_CRN'] - 0, "User_Data_Id": req.body.User_Data_Id}, {$set: objProduct}, function (err, objKyCDetails) {
                                            if (err) {
                                                res.json({"Insurer": "TATA_AIG", "Msg": 'KYC fetch services failed due to KYC Details not Updated. Please try again later.', "Status": "Fail"});
                                            } else {
                                                client.get(config.environment.weburl + '/kyc_details/get_kyc_status/' + user_datas['PB_CRN'] + '/' + req.body.udid, {}, function (db_kyc_details, response) {
                                                    if (db_kyc_details) {
                                                        let verify_kyc_service_url = ((config.environment.name !== 'Production') ? 'https://uatapigw.tataaig.com/ckyc/verify?product=' + product_name : '');
                                                        let verify_args = {
                                                            "quote_id": db_kyc_details.Quote_Id,
                                                            "id_type": (req.body.Search_Type === undefined || req.body.Search_Type === "" || req.body.Search_Type === null) ? "" : req.body.Search_Type,
                                                            "id_num": (req.body.PAN === undefined || req.body.PAN === "" || req.body.PAN === null) ? "" : req.body.PAN,
                                                            "customer_name": full_name
                                                        };
                                                        let kyc_verify_args = {
                                                            data: verify_args,
                                                            headers: {
                                                                "Content-Type": "application/json",
                                                                "Authorization": token,
                                                                "x-api-key": ((config.environment.name !== 'Production') ? 'g8hoqi8TBA2mBpxgMohdTcWxAfv6JsJ6wLztOWm4' : '')
                                                            }
                                                        };
                                                        let client1 = new Client();
                                                        client1.post(verify_kyc_service_url, kyc_verify_args, function (kyc_verify_data, response) {
                                                            if (kyc_verify_data) {
                                                                let LM_Data = {
                                                                    'KYC_Obj': {
                                                                        'kyc_id': ''
                                                                    },
                                                                    'LM_Obj': {
                                                                        'iskycVerified': '',
                                                                        'redirect_link': '',
                                                                        'status': ''
                                                                    },
                                                                    'TATA_AIG_Obj': {
                                                                        'data': ''
                                                                    },
                                                                    'tmp_Obj': ''
                                                                };
                                                                if (kyc_verify_data.hasOwnProperty("status") && kyc_verify_data.status === 200 && kyc_verify_data.hasOwnProperty('data') && kyc_verify_data.data.hasOwnProperty('ckyc_number') && kyc_verify_data.data.ckyc_number) {
                                                                    kyc_id = kyc_verify_data.data.ckyc_number;
                                                                    KYC_Status = "SUCCESS";
                                                                    LM_Data.KYC_Obj.kyc_id = kyc_id;
                                                                    LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                                                                } else {
                                                                    KYC_Status = "PENDING";
                                                                    LM_Data.TATA_AIG_Obj.data = kyc_verify_data;
                                                                    LM_Data.tmp_Obj = LM_Data.TATA_AIG_Obj.data;
                                                                }
                                                                try {
                                                                    let queryObj = {
                                                                        'Insurer_Id': req.body.insurer_id,
                                                                        'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                                                                        'KYC_Number': kyc_id,
                                                                        'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                                        'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                                        'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                                        'KYC_Status': KYC_Status,
                                                                        'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                                        'Created_On': new Date(),
                                                                        'Modified_On': new Date(),
                                                                        'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                                        'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                                                                        'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                                        'CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                                                                    };
                                                                    var kyc_detail1 = new kyc_detail(queryObj);
                                                                    kyc_detail1.save(queryObj, function (err, users) {
                                                                        if (err) {
                                                                            res.json({"Insurer": "TATA_AIG", "Msg": err, "Status": "FAIL"});
                                                                        } else {
                                                                            console.error({"Insurer": "TATA_AIG", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                                        }
                                                                    });
                                                                    let queryObj1 = {
                                                                        'CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                                                                        'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                                                                        'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                                                                        'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                                                                        'DOB': (req.body.dob === undefined || req.body.dob === "" || req.body.dob === null) ? "" : req.body.dob,
                                                                        'Mobile': (req.body.mobile === undefined || req.body.mobile === "" || req.body.mobile === null) ? "" : req.body.mobile,
                                                                        'Email': (req.body.email === undefined || req.body.email === "" || req.body.email === null) ? "" : req.body.email,
                                                                        'Insurer_Id': req.body.insurer_id,
                                                                        'KYC_Request_Core': verify_args,
                                                                        'KYC_Response_Core': kyc_verify_data,
                                                                        'Status': "completed",
                                                                        'Created_On': new Date(),
                                                                        'Modified_On': new Date()
                                                                    };
                                                                    var kyc_history1 = new kyc_history(queryObj1);
                                                                    kyc_history1.save(queryObj1, function (err, users) {
                                                                        if (err) {
                                                                            res.json({"Insurer": "TATA_AIG", "Msg": err, "Status": "FAIL"});
                                                                        } else {
                                                                            console.error({"Insurer": "TATA_AIG", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                                                        }
                                                                    });
                                                                } catch (e) {
                                                                    res.json({"Insurer": "TATA_AIG", "Msg": e.stack, "Status": "FAIL"});
                                                                }
                                                                res.json({"Insurer": "TATA_AIG", "Msg": kyc_verify_data.data, "Status": KYC_Status});
                                                            } else {
                                                                res.json({"Insurer": "TATA_AIG", "Msg": "KYC fetch services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                                                            }
                                                        });
                                                    } else {
                                                        res.json({"Insurer": "TATA_AIG", "Msg": "KYC fetch services failed due to no details available in KYC Details Database. Please try again later.", "Status": "FAIL"});
                                                    }
                                                });
                                            }
                                        });
                                    } else {
                                        res.json({"Insurer": "TATA_AIG", "Msg": "KYC fetch services failed due to no details available in user data. Please try again later.", "Status": "FAIL"});
                                    }
                                });
                            } else {
                                res.json({"Insurer": "TATA_AIG", "Msg": "Could Not Generate Token. Please try again later.", "Status": "FAIL"});
                            }
                        } catch (e2) {
                            res.json({"Insurer": "TATA_AIG", "Msg": e2.stack, "Status": "FAIL"});
                        }
                    } else {
                        res.json({"Insurer": "TATA_AIG", "Msg": "KYC-Token generation services was not successful. Please try again later.", "Status": "FAIL"});
                    }
                } else {
                    res.json({"Insurer": "TATA_AIG", "Msg": "KYC-Token generation services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "TATA_AIG", "Msg": e1.stack, "Status": "FAIL"});
        }
    });
    
    app.get('/kyc_details/tataaig_update_proposal_kyc/:udid', function (req, res) {
        let udid = req.params['udid'] - 0;
        let Client = require('node-rest-client').Client;
        let client = new Client();
        let user_datas = {};
        client.get(config.environment.weburl + '/user_datas/view/' + udid, {}, function (db_user_data, response) {
            if (db_user_data) {
                user_datas = db_user_data[0];
                var objProduct = {
                    "Proposal_Id": user_datas.Insurer_Transaction_Identifier,
                    "Modified_On": new Date()
                };
                kyc_detail.update({"PB_CRN": user_datas['PB_CRN'] - 0, "User_Data_Id": udid}, {$set: objProduct}, function (err, objKyCDetails) {
                    if (err) {
                        res.json({"Insurer": "TATA_AIG", "Msg": "tataaig_update_proposal_kyc services failed due to kyc details not updated. Please try again later.", "Status": "FAIL"});
                    } else {
                        client.get(config.environment.weburl + '/kyc_details/get_kyc_status/' + user_datas['PB_CRN'] + '/' + udid, {}, function (db_kyc_details, response) {
                            if (db_kyc_details) {
                                let obj_Kyc_details = db_kyc_details['Msg'][0];
                                let t = ((config.environment.name !== 'Production') ? '2D9D1BC5A837E7A2741C6121317E9EE6CE1D32145CBCF7084FA4493ECDA2C2804969A5473610BC2AB4FC034359C11D55F99F8AEC736D84F0EFD531DFE24FFC74F0923F1288A83121B8045A8AAA4D9F920B4D737E3A1134B824E23B1F0561D97AEA647554A31570720BDB6E4CE3D8813A1138ABF16F2A23A8E6BAB012DD07B768019A5B583351F6D36C1F6F26B5C8D474D2F701E664A96F73806EE3A5235DEFFD76CF4106F7F074A55258D75B1DDEFD38' : '');
                                let product_code = ((config.environment.name !== 'Production') ? '3121' : '');
                                let update_args = {
                                    "T": t,
                                    "product_code": product_code,
                                    "proposal_no": obj_Kyc_details.Proposal_Id,
                                    "p_ckyc_pan": obj_Kyc_details.PAN,
                                    "p_ckyc_no": obj_Kyc_details.KYC_Number,
                                    "p_ckyc_id_type": obj_Kyc_details.Search_Type,
                                    "p_ckyc_id_no": "",
                                    "timestamp": moment().format(), //"2022-12-22T05:05:30.816Z"
                                    "kyc_status": obj_Kyc_details.KYC_Status
                                };
                                let kyc_token_args = {
                                    data: update_args,
                                    headers: {
                                        "Content-Type": "application/x-www-form-urlencoded"
                                    }
                                };
                                function jsonToQueryString(json) {
                                    return  Object.keys(json).map(function (key) {
                                        return encodeURIComponent(key) + '=' +
                                                encodeURIComponent(json[key]);
                                    }).join('&');
                                }
                                update_args.data = jsonToQueryString(update_args.data);
                                let Client1 = require('node-rest-client').Client;
                                let client1 = new Client1();
                                let update_kyc_detail = ((config.environment.name !== 'Production') ? 'https://pipuat.tataaiginsurance.in/tagichubms/ws/v1/ws/getws/kycdet' : '');
                                client1.post(update_kyc_detail, kyc_token_args, function (get_update_date, response12) {
                                    if (get_update_date && get_update_date.hasOwnProperty('status') && get_update_date['status'] === "1" && get_update_date.hasOwnProperty('errcode') && get_update_date['errcode'] === "KYC002") {
                                        res.json({"Insurer": "TATA_AIG", "Msg": get_update_date, "Status": "SUCCESS"}); 
                                    } else {
                                       res.json({"Insurer": "TATA_AIG", "Msg": get_update_date, "Status": "FAIL"}); 
                                    }
                                });
                            } else {
                                res.json({"Insurer": "TATA_AIG", "Msg": "tataaig_update_proposal_kyc services failed due to no kyc details found. Please try again later.", "Status": "FAIL"});
                            }
                        });
                    }
                });
            } else {
                res.json({"Insurer": "TATA_AIG", "Msg": "tataaig_update_proposal_kyc services failed due to no details found from user data. Please try again later.", "Status": "FAIL"});
            }
        });
    });
    app.post('/kyc_details/iffco_create_kyc_details', function (req, res) {
        try {
            let req_txt = {
             "prefix": (req.body.Proposal_Request.salutation === undefined || req.body.Proposal_Request.salutation === "" || req.body.Proposal_Request.salutation === null) ? "" : req.body.Proposal_Request.salutation,
             "firstName": (req.body.Proposal_Request.first_name === undefined || req.body.Proposal_Request.first_name === "" || req.body.Proposal_Request.first_name === null) ? "" : req.body.Proposal_Request.first_name,
             "middleName": (req.body.Proposal_Request.middle_name === undefined || req.body.Proposal_Request.middle_name === "" || req.body.Proposal_Request.middle_name === null) ? "" : req.body.Proposal_Request.middle_name,
             "lastName": (req.body.Proposal_Request.last_name === undefined || req.body.Proposal_Request.last_name === "" || req.body.Proposal_Request.last_name === null) ? "" : req.body.Proposal_Request.last_name,
             "relatedPersonPrefix": "Mr.",
             "relatedPersonFirstName": (req.body.Proposal_Request.nominee_first_name === undefined || req.body.Proposal_Request.nominee_first_name === "" || req.body.Proposal_Request.nominee_first_name === null) ? "" : req.body.Proposal_Request.nominee_first_name,
             "relatedPersonMiddleName": (req.body.Proposal_Request.nominee_middle_name === undefined || req.body.Proposal_Request.nominee_middle_name === "" || req.body.Proposal_Request.nominee_middle_name === null) ? "" : req.body.Proposal_Request.nominee_middle_name,
             "relatedPersonLastName": (req.body.Proposal_Request.nominee_last_name === undefined || req.body.Proposal_Request.nominee_last_name === "" || req.body.Proposal_Request.nominee_last_name === null) ? "" : req.body.Proposal_Request.nominee_last_name,
             "gender": (req.body.Proposal_Request.gender === undefined || req.body.Proposal_Request.gender === "" || req.body.Proposal_Request.gender === null) ? "" : req.body.Proposal_Request.gender,
             "dateofBirth": (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
             "minor": moment().diff(moment(req.body.Proposal_Request.dob, 'DD/MM/YYYY'), 'years') >= 18 ? "Y" : "N",
             "addressLine1": (req.body.Proposal_Request.permanent_address_1 === undefined || req.body.Proposal_Request.permanent_address_1 === "" || req.body.Proposal_Request.permanent_address_1 === null) ? "" : req.body.Proposal_Request.permanent_address_1,
             "pinCode": (req.body.Proposal_Request.permanent_pincode === undefined || req.body.Proposal_Request.permanent_pincode === "" || req.body.Proposal_Request.permanent_pincode === null) ? "" : req.body.Proposal_Request.permanent_pincode,
             "city": (req.body.Proposal_Request.permanent_city === undefined || req.body.Proposal_Request.permanent_city === "" || req.body.Proposal_Request.permanent_city === null) ? "" : req.body.Proposal_Request.permanent_city,
             "state": (req.body.Proposal_Request.permanent_state === undefined || req.body.Proposal_Request.permanent_state === "" || req.body.Proposal_Request.permanent_state === null) ? "" : req.body.Proposal_Request.permanent_state,
             "country": "India",
             "district": (req.body.Proposal_Request.permanent_city === undefined || req.body.Proposal_Request.permanent_city === "" || req.body.Proposal_Request.permanent_city === null) ? "" : req.body.Proposal_Request.permanent_city,
             "correspondenceAddressLine1": (req.body.Proposal_Request.communication_address_1 === undefined || req.body.Proposal_Request.communication_address_1 === "" || req.body.Proposal_Request.communication_address_1 === null) ? "" : req.body.Proposal_Request.communication_address_1,
             "correspondencePinCode": (req.body.Proposal_Request.communication_pincode === undefined || req.body.Proposal_Request.communication_pincode === "" || req.body.Proposal_Request.communication_pincode === null) ? "" : req.body.Proposal_Request.communication_pincode,
             "correspondenceCity": (req.body.Proposal_Request.communication_city === undefined || req.body.Proposal_Request.communication_city === "" || req.body.Proposal_Request.communication_city === null) ? "" : req.body.Proposal_Request.communication_city,
             "correspondenceState": (req.body.Proposal_Request.communication_state === undefined || req.body.Proposal_Request.communication_state === "" || req.body.Proposal_Request.communication_state === null) ? "" : req.body.Proposal_Request.communication_state,
             "correspondenceCountry": "India",
             "correspondenceDistrict": (req.body.Proposal_Request.communication_city === undefined || req.body.Proposal_Request.communication_city === "" || req.body.Proposal_Request.communication_city === null) ? "" : req.body.Proposal_Request.communication_city,
             "kycDocuments": [
             {
             "idType": "IDENTITY_PROOF",
             "idName": "PAN",
             "idNumber": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
             "fileName": (req.body.pan_file_name === undefined || req.body.pan_file_name === "" || req.body.pan_file_name === null) ? "" : req.body.pan_file_name,
             "fileExtension": (req.body.pan_file_extension === undefined || req.body.pan_file_extension === "" || req.body.pan_file_extension === null) ? "" : req.body.pan_file_extension,
             "fileBase64": (req.body.upload_pan === undefined || req.body.upload_pan === "" || req.body.upload_pan === null) ? "" : req.body.upload_pan
             },
             {
             "idType": "ADDRESS_PROOF",
             "idName": "AADHAR CARD NUMBER",
             "idNumber": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
             "fileName": (req.body.aadhar_file_name === undefined || req.body.aadhar_file_name === "" || req.body.aadhar_file_name === null) ? "" : req.body.aadhar_file_name,
             "fileExtension": (req.body.aadhar_file_extension === undefined || req.body.aadhar_file_extension === "" || req.body.aadhar_file_extension === null) ? "" : req.body.aadhar_file_extension,
             "fileBase64": (req.body.upload_aadhar === undefined || req.body.upload_aadhar === "" || req.body.upload_aadhar === null) ? "" : req.body.upload_aadhar
             }
             ]
             };
            /*let req_txt = {
                "prefix": "Mr.",
                "firstName": "Jon",
                "middleName": "Mathew",
                "lastName": "Kee",
                "relatedPersonPrefix": "Mr.",
                "relatedPersonFirstName": "Mathew",
                "relatedPersonMiddleName": "Paul",
                "relatedPersonLastName": "Kee",
                "gender": "M",
                "dateofBirth": "01-01-1977",
                "minor": "N",
                "addressLine1": "HNO 1A",
                "pinCode": "222111",
                "city": "Hyderabad",
                "state": "Telangana",
                "country": "India",
                "district": "Hyderabad",
                "correspondenceAddressLine1": "HNO 15/2",
                "correspondencePinCode": "560035",
                "correspondenceCity": "Bangalore",
                "correspondenceState": "Karnataka",
                "correspondenceCountry": "India",
                "correspondenceDistrict": "Bangalore City",
                "kycDocuments": [
                    {
                        "idType": "IDENTITY_PROOF",
                        "idName": "PAN",
                        "idNumber": "MDAPS6418B",
                        "fileName": "PANCARD.jpeg",
                        "fileExtension": "jpeg",
                        "fileBase64": "data:@file/jpeg;base64,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"
                    },
                    {
                        "idType": "ADDRESS_PROOF",
                        "idName": "DRIVING LICENSE",
                        "idNumber": "wqqw2",
                        "fileName": "DL.jpeg",
                        "fileExtension": "jpeg",
                        "fileBase64": "data:@file/jpeg;base64,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"
                    }
                ]
            }*/
            let auth = 'Basic ' + Buffer.from('ITGIMOT001:partner@2020').toString('base64');
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    'Authorization': auth
                }
            };
            let upload_req_txt = {
                "firstName": (req.body.first_name === undefined || req.body.first_name === "" || req.body.first_name === null) ? "" : req.body.first_name,
                "lastName": (req.body.last_name === undefined || req.body.last_name === "" || req.body.last_name === null) ? "" : req.body.last_name,
                "dateofBirth": (req.body.birth_date === undefined || req.body.birth_date === "" || req.body.birth_date === null) ? "" : req.body.birth_date,
                "kycDocuments": [
                    {
                        "idType": "IDENTITY_PROOF",
                        "idName": "PAN",
                        "idNumber": (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                        "fileName": (req.body.pan_file_name === undefined || req.body.pan_file_name === "" || req.body.pan_file_name === null) ? "" : req.body.pan_file_name,
                        "fileExtension": (req.body.pan_file_extension === undefined || req.body.pan_file_extension === "" || req.body.pan_file_extension === null) ? "" : req.body.pan_file_extension,
                        "fileBase64": (req.body.upload_aadhar === undefined || req.body.upload_aadhar === "" || req.body.upload_aadhar === null) ? "" : req.body.upload_aadhar,
                    },
                    {
                        "idType": "ADDRESS_PROOF",
                        "idName": "AADHAR CARD NUMBER",
                        "idNumber": (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                        "fileName": (req.body.aadhar_file_name === undefined || req.body.aadhar_file_name === "" || req.body.aadhar_file_name === null) ? "" : req.body.aadhar_file_name,
                        "fileExtension": (req.body.aadhar_file_extension === undefined || req.body.aadhar_file_extension === "" || req.body.aadhar_file_extension === null) ? "" : req.body.aadhar_file_extension,
                        "fileBase64": (req.body.upload_aadhar === undefined || req.body.upload_aadhar === "" || req.body.upload_aadhar === null) ? "" : req.body.upload_aadhar,
                    }
                ]
            };
            let KYC_Status = "PENDING";
            let kyc_id = 0;
            var Client = require('node-rest-client').Client;
            var client = new Client();
            var call_upload = false;
            /* IMAGE SAVE START */
            var path = appRoot + "/tmp/kyc_documents/" + req.body.crn;
            var Kyc_doc_file_name = '';
            var doc = [];
            var aadhar_path = '';
            var pan_path = '';
            if (req.body.hasOwnProperty('upload_pan')) {
                doc.push({'doc_name': req.body.pan_file_name, 'doc_data': req.body.upload_pan});
                pan_path = "/tmp/kyc_documents/" + req.body.crn + "/" + req.body.pan_file_name;
            }
            if (req.body.hasOwnProperty('upload_aadhar')) {
                doc.push({'doc_name': req.body.aadhar_file_name, 'doc_data': req.body.upload_aadhar});
                aadhar_path = "/tmp/kyc_documents/" + req.body.crn + "/" + req.body.aadhar_file_name;
            }
            try {
                for (var i = 0; i < doc.length; i++) {
                    var doc_decoded = decodeURIComponent(doc[i]['doc_data']);
                    if (!fs.existsSync(appRoot + "/tmp/kyc_documents")) {
                        fs.mkdirSync(appRoot + "/tmp/kyc_documents");
                    }
                    if (fs.existsSync(path)) {
                        var data = doc_decoded.replace(/^data:image\/\w+;base64,/, "");
                        if (data === "") {
                             res.json({"Insurer": "IFFCO", "Msg": 'Image Unavailable', "Status": KYC_Status});
                        } else {
                            var buf = new Buffer(data, 'base64');
                            fs.writeFileSync(path + '/' + doc[i]['doc_name'], buf);
                        }
                    } else {
                        fs.mkdirSync(path);
                        var data = doc_decoded.replace(/^data:image\/\w+;base64,/, "");
                        if (data === "") {
                            res.json({"Insurer": "IFFCO", "Msg": 'Image Unavailable', "Status": KYC_Status});
                        } else {
                            var buf = new Buffer(data, 'base64');
                            fs.writeFileSync(path + '/' + Kyc_doc_file_name, buf);
                        }
                    }
                }
                req.body.Aadhar_Doc = aadhar_path;
                req.body.PAN_Doc = pan_path;

            } catch (err) {
                res.json({"Insurer": "IFFCO", "Msg": err.stack, "Status": "FAIL"});
            }
            /* IMAGE SAVE END */
            client.post("https://staging.iffcotokio.co.in/partner-services/kyc/create", args, function (data, response) {
                try {
                    let LM_Data = {
                        'KYC_Obj': {
                            'kyc_id': ''
                        },
                        'LM_Obj': {
                            'iskycVerified': '',
                            'redirect_link': '',
                            'status': ''
                        },
                        'Iffco_Obj': {
                            'data': ''
                        },
                        'tmp_Obj': ''
                    };
                    if (data.hasOwnProperty("status") && data.status === 200 && data.hasOwnProperty("result")) {
                        if (data.result.hasOwnProperty("status") && (data.result.status === 'SUCCESS' || data.result.status === 'EXISTING RECORD') && data.result.hasOwnProperty("itgiUniqueReferenceId") && data.result.itgiUniqueReferenceId) {
                            kyc_id = data.result.itgiUniqueReferenceId;
                            KYC_Status = "SUCCESS";
                            LM_Data.KYC_Obj.kyc_id = kyc_id;
                            LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                        } else {
                            call_upload = true;
                            kyc_id = data.result.itgiUniqueReferenceId;
                            KYC_Status = "FAIL";
                            LM_Data.KYC_Obj.kyc_id = kyc_id;
                            LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                            upload_req_txt.itgiUniqueReferenceId = data.result.itgiUniqueReferenceId;
                            let upload_args = {
                                data: JSON.stringify(upload_req_txt),
                                headers: {
                                    "Content-Type": "application/json",
                                    "Accept": "application/json"
                                }
                            };
                            client.post("https://staging.iffcotokio.co.in/partner-services/kyc/upload", upload_args, function (data, response) {
                                console.log('iffco_fetch_kyc_details upload doc api data - ' + data);
                                if (data.hasOwnProperty("status") && data.status === 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty('apiStatus') && data.result.apiStatus === "SUCCESS") {
                                    res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                } else {
                                    res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                                }
                            });
                        }
                    } else if (data && data.hasOwnProperty("status") && data.status !== 200 && data.hasOwnProperty("errors")) {
                        kyc_id = data.result.itgiUniqueReferenceId;
                        KYC_Status = "FAIL";
                        LM_Data.Iffco_Obj.data = data.errors;
                        LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;
                    } else {
                        KYC_Status = "FAIL";
                        LM_Data.Iffco_Obj.data = data;
                        LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;
                    }
                    try {
                        let queryObj = {
                            'Insurer_Id': req.body.insurer_id,
                            'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                            'KYC_Number': kyc_id,
                            'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'KYC_Status': KYC_Status,
                            'DOB': (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
                            'Created_On': new Date(),
                            'Modified_On': new Date(),
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                            'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                        };
                        var kyc_detail1 = new kyc_detail(queryObj);
                        kyc_detail1.save(queryObj, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "IFFCO", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "IFFCO", "Msg": data.data, "Status": KYC_Status});
                            }
                        });
                        let queryObj1 = {
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'DOB': (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
                            'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                            'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                            'Insurer_Id': req.body.insurer_id,
                            'KYC_Request_Core': req_txt,
                            'KYC_Response_Core': data,
                            'Status': "completed",
                            'Created_On': new Date(),
                            'Modified_On': new Date()
                        };
                        var kyc_history1 = new kyc_history(queryObj1);
                        kyc_history1.save(queryObj1, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "IFFCO", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "IFFCO", "Msg": data.data, "Status": KYC_Status});
                            }
                        });
                    } catch (e) {
                        res.json({"Insurer": "IFFCO", "Msg": e.stack, "Status": "FAIL"});
                    }
                    if (!call_upload) {
                        res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                    }
                } catch (err) {
                    res.json({"Insurer": "IFFCO", "Msg": err.stack, "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "IFFCO", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/iffco_fetch_kyc_details', function (req, res) {
        try {
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            let req_txt = {
                "firstName": (req.body.Proposal_Request.first_name === undefined || req.body.Proposal_Request.first_name === "" || req.body.Proposal_Request.first_name === null) ? "" : req.body.Proposal_Request.first_name,
                "lastName": (req.body.Proposal_Request.last_name === undefined || req.body.Proposal_Request.last_name === "" || req.body.Proposal_Request.last_name === null) ? "" : req.body.Proposal_Request.last_name,
                "dateofBirth": (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null || req.body.Proposal_Request.birth_date === "Invalid Date") ? "" : moment(req.body.Proposal_Request.birth_date, 'DD/MM/YYYY').format('DD-MM-YYYY'),
                "gender": (req.body.Proposal_Request.gender === undefined || req.body.Proposal_Request.gender === "" || req.body.Proposal_Request.gender === null) ? "" : req.body.Proposal_Request.gender
            };
            if (req.body.Proposal_Request.hasOwnProperty('pan') && req.body.Proposal_Request.pan !== undefined && req.body.Proposal_Request.pan !== "" && req.body.Proposal_Request.pan !== null) {
                req_txt['idType'] = 'PAN';
                req_txt['idNumber'] = req.body.Proposal_Request.pan;
            } else if (req.body.Proposal_Request.hasOwnProperty('aadhar') && req.body.Proposal_Request.aadhar !== undefined && req.body.Proposal_Request.aadhar !== "" && req.body.Proposal_Request.aadhar !== null) {
                req_txt['idType'] = 'AADHAR CARD NUMBER';
                req_txt['idNumber'] = req.body.Proposal_Request.aadhar;
            }
            var auth = 'Basic ' + Buffer.from('ITGIMOT001:partner@2020').toString('base64');
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    'Authorization': auth
                }
            };
            let KYC_Status = "PENDING";
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.post("https://staging.iffcotokio.co.in/partner-services/kyc/fetch", args, function (data, response) {
                if (data) {
                    let LM_Data = {
                        'KYC_Obj': {
                            'kyc_id': ''
                        },
                        'LM_Obj': {
                            'iskycVerified': '',
                            'redirect_link': '',
                            'status': ''
                        },
                        'Iffco_Obj': {
                            'data': ''
                        },
                        'tmp_Obj': ''
                    };
                    if (data.hasOwnProperty("status") && data.status === 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty("itgiUniqueReferenceId") && data.result.itgiUniqueReferenceId) {
                        //kyc_id = data.result.itgiUniqueReferenceId;
                        KYC_Status = "SUCCESS";
                        LM_Data.KYC_Obj.kyc_id = data.result.itgiUniqueReferenceId;
                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                        /*}else if (data && data.hasOwnProperty("status") && data.status === 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty("apiStatus") && data.result.apiStatus === "No Record") {
                         KYC_Status = "FAIL";
                         LM_Data.Iffco_Obj.data = data.result;
                         LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;
                         }else if (data && data.hasOwnProperty("status") && data.status !== 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty("apiStatus") && data.result.apiStatus) {
                         KYC_Status = "FAIL";
                         LM_Data.Iffco_Obj.data = data.result;
                         LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;*/
                    } else {
                        KYC_Status = "FAIL";
                        LM_Data.Iffco_Obj.data = data.result;
                        LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;
                    }

                    try {
                        //data.data.Msg.kyc_id = user_kyc_no;
                        let queryObj = {
                            'Insurer_Id': req.body.insurer_id,
                            'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                            'KYC_Number': user_kyc_no,
                            'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'KYC_Status': KYC_Status,
                            'DOB': (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
                            'Created_On': new Date(),
                            'Modified_On': new Date(),
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                            'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                        };
                        var kyc_detail1 = new kyc_detail(queryObj);
                        kyc_detail1.save(queryObj, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "IFFCO", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                            }
                        });
                        let queryObj1 = {
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'DOB': (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
                            'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                            'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                            'Insurer_Id': req.body.insurer_id,
                            'KYC_Request_Core': req_txt,
                            'KYC_Response_Core': data,
                            'Status': "completed",
                            'Created_On': new Date(),
                            'Modified_On': new Date()
                        };
                        var kyc_history1 = new kyc_history(queryObj1);
                        kyc_history1.save(queryObj1, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "IFFCO", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                            }
                        });
                    } catch (e) {
                        res.json({"Insurer": "IFFCO", "Msg": e.stack, "Status": "FAIL"});
                    }
                    res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                } else {
                    res.json({"Insurer": "IFFCO", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "IFFCO", "Msg": e1.stack, "Status": "FAIL"});
        }
    });

    app.post('/kyc_details/iffco_verify_kyc_details', function (req, res) {
        try {
            var user_kyc_no = (req.body.user_kyc_no === undefined || req.body.user_kyc_no === "" || req.body.user_kyc_no === null) ? "" : req.body.user_kyc_no;
            let req_txt = {
                "firstName": (req.body.Proposal_Request.first_name === undefined || req.body.Proposal_Request.first_name === "" || req.body.Proposal_Request.first_name === null) ? "" : req.body.Proposal_Request.first_name,
                "lastName": (req.body.Proposal_Request.last_name === undefined || req.body.Proposal_Request.last_name === "" || req.body.Proposal_Request.last_name === null) ? "" : req.body.Proposal_Request.last_name,
                "dateofBirth": (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null || req.body.Proposal_Request.birth_date === "Invalid Date") ? "" : moment(req.body.Proposal_Request.birth_date, 'DD/MM/YYYY').format('DD-MM-YYYY'),
                "gender": (req.body.Proposal_Request.gender === undefined || req.body.Proposal_Request.gender === "" || req.body.Proposal_Request.gender === null) ? "" : req.body.Proposal_Request.gender
            };
            if (req.body.Proposal_Request.hasOwnProperty('pan') && req.body.Proposal_Request.pan !== undefined && req.body.Proposal_Request.pan !== "" && req.body.Proposal_Request.pan !== null) {
                req_txt['idType'] = 'PAN';
                req_txt['idNumber'] = req.body.Proposal_Request.pan;
            } else if (req.body.Proposal_Request.hasOwnProperty('aadhar') && req.body.Proposal_Request.aadhar !== undefined && req.body.Proposal_Request.aadhar !== "" && req.body.Proposal_Request.aadhar !== null) {
                req_txt['idType'] = 'AADHAR CARD NUMBER';
                req_txt['idNumber'] = req.body.Proposal_Request.aadhar;
            }
            var auth = 'Basic ' + Buffer.from('ITGIMOT001:partner@2020').toString('base64');
            let args = {
                data: JSON.stringify(req_txt),
                headers: {
                    "Content-Type": "application/json",
                    "Accept": "application/json",
                    'Authorization': auth
                }
            };
            let KYC_Status = "PENDING";
            var Client = require('node-rest-client').Client;
            var client = new Client();
            client.post("https://staging.iffcotokio.co.in/partner-services/kyc/fetch", args, function (data, response) {
                if (data) {
                    let LM_Data = {
                        'KYC_Obj': {
                            'kyc_id': ''
                        },
                        'LM_Obj': {
                            'iskycVerified': '',
                            'redirect_link': '',
                            'status': ''
                        },
                        'Iffco_Obj': {
                            'data': ''
                        },
                        'tmp_Obj': ''
                    };
                    if (data.hasOwnProperty("status") && data.status === 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty("itgiUniqueReferenceId") && data.result.itgiUniqueReferenceId) {
                        //kyc_id = data.result.itgiUniqueReferenceId;
                        KYC_Status = "SUCCESS";
                        LM_Data.KYC_Obj.kyc_id = data.result.itgiUniqueReferenceId;
                        LM_Data.tmp_Obj = LM_Data.KYC_Obj;
                        /*}else if (data && data.hasOwnProperty("status") && data.status === 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty("apiStatus") && data.result.apiStatus === "No Record") {
                         KYC_Status = "FAIL";
                         LM_Data.Iffco_Obj.data = data.result;
                         LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;
                         }else if (data && data.hasOwnProperty("status") && data.status !== 200 && data.hasOwnProperty("result") && data.result.hasOwnProperty("apiStatus") && data.result.apiStatus) {
                         KYC_Status = "FAIL";
                         LM_Data.Iffco_Obj.data = data.result;
                         LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;*/
                    } else {
                        KYC_Status = "FAIL";
                        LM_Data.Iffco_Obj.data = data.result;
                        LM_Data.tmp_Obj = LM_Data.Iffco_Obj.data;
                    }

                    try {
                        //data.data.Msg.kyc_id = user_kyc_no;
                        let queryObj = {
                            'Insurer_Id': req.body.insurer_id,
                            'Search_Type': (req.body.search_type === undefined || req.body.search_type === "" || req.body.search_type === null) ? "" : req.body.search_type,
                            'KYC_Number': user_kyc_no,
                            'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'KYC_Status': KYC_Status,
                            'DOB': (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
                            'Created_On': new Date(),
                            'Modified_On': new Date(),
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'Product_Id': (req.body.product_id === undefined || req.body.product_id === "" || req.body.product_id === null) ? 0 : req.body.product_id,
                            'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn
                        };
                        var kyc_detail1 = new kyc_detail(queryObj);
                        kyc_detail1.save(queryObj, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "IFFCO", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                            }
                        });
                        let queryObj1 = {
                            'PB_CRN': (req.body.crn === undefined || req.body.crn === "" || req.body.crn === null) ? "" : req.body.crn,
                            'User_Data_Id': (req.body.udid === undefined || req.body.udid === "" || req.body.udid === null) ? 0 : req.body.udid,
                            'PAN': (req.body.pan === undefined || req.body.pan === "" || req.body.pan === null) ? "" : req.body.pan,
                            'Aadhaar': (req.body.aadhar === undefined || req.body.aadhar === "" || req.body.aadhar === null) ? "" : req.body.aadhar,
                            'DOB': (req.body.Proposal_Request.birth_date === undefined || req.body.Proposal_Request.birth_date === "" || req.body.Proposal_Request.birth_date === null) ? "" : req.body.Proposal_Request.birth_date,
                            'Mobile': (req.body.Proposal_Request.mobile === undefined || req.body.Proposal_Request.mobile === "" || req.body.Proposal_Request.mobile === null) ? "" : req.body.Proposal_Request.mobile,
                            'Email': (req.body.Proposal_Request.email === undefined || req.body.Proposal_Request.email === "" || req.body.Proposal_Request.email === null) ? "" : req.body.Proposal_Request.email,
                            'Insurer_Id': req.body.insurer_id,
                            'KYC_Request_Core': req_txt,
                            'KYC_Response_Core': data,
                            'Status': "completed",
                            'Created_On': new Date(),
                            'Modified_On': new Date()
                        };
                        var kyc_history1 = new kyc_history(queryObj1);
                        kyc_history1.save(queryObj1, function (err, users) {
                            if (err) {
                                res.json({"Insurer": "IFFCO", "Msg": err, "Status": "FAIL"});
                            } else {
                                //res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                            }
                        });
                    } catch (e) {
                        res.json({"Insurer": "IFFCO", "Msg": e.stack, "Status": "FAIL"});
                    }
                    res.json({"Insurer": "IFFCO", "Msg": LM_Data.tmp_Obj, "Status": KYC_Status});
                } else {
                    res.json({"Insurer": "IFFCO", "Msg": "KYC verify services failed due to technical issue. Please try again later.", "Status": "FAIL"});
                }
            });
        } catch (e1) {
            res.json({"Insurer": "IFFCO", "Msg": e1.stack, "Status": "FAIL"});
        }
    });
//    app.post('/bajaj_enc', function (req, res) {
//        // encode
//        let token = jwt.encode(req.body, secret, 'HS512');
//        res.send(token);
//    });
//
//    app.post('/bajaj_dec', function (req, res) {
//        // decode
//        let decoded = jwt.decode(req.body.token, secret, false, 'HS512');
//        res.send(decoded);
//    });
};
